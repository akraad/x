<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ابزارک‌های هوشمند</title>
    <link href="https://cdn.fontcdn.ir/Font/Persian/Shabnam/Shabnam.css" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Shabnam', 'Vazirmatn', sans-serif;
            background-color: #1a1a1a; /* Dark background */
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #f0f0f0; /* Light text */
            padding: 20px;
            box-sizing: border-box;
        }

        /* --- Dynamic Navbar Styles --- */
        .navbar {
            display: flex;
            justify-content: center;
            background-color: #2a2a2a; /* Slightly lighter dark */
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            padding: 10px 15px;
            margin-bottom: 30px;
            width: 100%;
            max-width: 950px;
            flex-wrap: wrap;
            gap: 10px;
            border: 1px solid #3a3a3a;
        }
        .nav-button {
            background-color: #3a3a3a;
            color: #e0e0e0;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-grow: 1;
            min-width: 130px;
            max-width: 190px;
            font-weight: 600;
            display: flex;
            flex-direction: column; /* Stack icon and text */
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            border: 1px solid transparent; /* Default transparent border */
        }
        .nav-button:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px; /* Border thickness */
            background-color: transparent;
            transition: background-color 0.3s ease;
        }

        /* Specific colors for each button's border and hover/active states */
        .nav-button[data-color="gold"]:before { background-color: #FFD700; } /* Gold */
        .nav-button[data-color="green"]:before { background-color: #28a745; } /* Green */
        .nav-button[data-color="orange"]:before { background-color: #FFA500; } /* Orange */
        .nav-button[data-color="purple"]:before { background-color: #800080; } /* Purple */
        .nav-button[data-color="blue"]:before { background-color: #1e90ff; } /* Blue */
        .nav-button[data-color="red"]:before { background-color: #dc3545; } /* Red */
        .nav-button[data-color="darkgreen"]:before { background-color: #006400; } /* Dark Green for Salawat */


        .nav-button:hover {
            background-color: #4a4a4a;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
            color: #ffffff;
        }
        .nav-button.active {
            background-color: #5a5a5a;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.5), inset 0 0 10px rgba(0, 0, 0, 0.3);
            transform: translateY(0);
            color: #ffffff;
            border-color: var(--button-color); /* Use CSS variable for active border */
        }
        .nav-button i {
            margin-bottom: 8px; /* Space between icon and text */
            margin-left: 0; /* Remove left margin for stacking */
            font-size: 1.3em;
            color: #bbb;
        }
        .nav-button.active i {
            color: #fff;
        }

        /* --- Common App Container Styles --- */
        .app-container {
            background-color: #2a2a2a; /* Darker grey background for containers */
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            padding: 30px;
            width: 100%;
            max-width: 450px;
            text-align: center;
            border: 1px solid #3a3a3a;
            display: none; /* Initially hidden */
            transition: all 0.4s ease-in-out;
        }
        .app-container h1 {
            margin-bottom: 25px;
            font-size: 1.8em;
            font-weight: 700;
            color: #ffffff;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
        }
        .input-group {
            margin-bottom: 20px;
            text-align: right;
            position: relative;
        }
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.95em;
            color: #e0e0e0;
        }
        .input-group input[type="number"],
        .input-group input[type="text"],
        .input-group select {
            width: calc(100% - 40px);
            padding: 12px 15px 12px 35px;
            border: 1px solid #555;
            border-radius: 8px;
            font-size: 1em;
            background-color: #3a3a3a;
            color: #f0f0f0;
            direction: ltr; /* Default for inputs */
            text-align: right;
            transition: border-color 0.3s, box-shadow 0.3s;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            padding-left: 45px;
        }

        .input-group select {
            width: calc(100% - 15px);
            padding-left: 15px; /* Adjust padding for select */
            direction: rtl; /* For Persian text in select */
            cursor: pointer;
        }
        .input-group select option {
            background-color: #3a3a3a; /* Darker background for options */
            color: #f0f0f0;
            padding: 8px;
        }

        .input-group input[type="number"]:focus,
        .input-group input[type="text"]:focus,
        .input-group select:focus {
            outline: none;
            border-color: #1e90ff; /* Default focus blue */
            box-shadow: 0 0 0 3px rgba(30, 144, 255, 0.3);
        }
        .input-group .icon {
            position: absolute;
            left: 12px;
            top: 50%; /* Center vertically with label and input */
            transform: translateY(calc(-50% + 12px)); /* Adjust for label height */
            color: #aaa;
            font-size: 1.1em;
            pointer-events: none; /* Make icon not clickable */
        }
        .input-group small {
            display: block;
            margin-top: 5px;
            color: #bbb;
            font-size: 0.8em;
            text-align: right;
        }
        .flex-inputs {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }
        .flex-inputs .input-group {
            flex: 1;
            margin-bottom: 0;
        }
        .flex-inputs .input-group label {
            white-space: nowrap;
        }
        .app-container button {
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1.05em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            width: 100%;
            font-weight: 600;
            margin-top: 25px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.4);
        }
        .app-container button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(0, 0, 0, 0.5);
        }
        .result {
            margin-top: 30px;
            background-color: #3a3a3a;
            border: 1px solid #555;
            border-radius: 10px;
            padding: 20px;
            font-size: 1.1em;
            color: #f0f0f0;
            font-weight: 600;
            display: none;
            text-align: right;
            line-height: 1.8;
            box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.4);
        }
        .result div {
            margin-bottom: 8px;
        }
        .result span {
            font-size: 1em;
            margin-right: 8px;
            font-weight: 700;
        }
        .result .small-text {
            font-size: 0.75em;
            color: #bbb;
            display: block;
            margin-top: 15px;
            font-weight: normal;
        }
        .personality-text {
            font-size: 1.05em;
            font-weight: normal;
            margin-top: 20px;
            text-align: justify;
            background-color: #3a3a3a;
            border: 1px dashed #555;
            padding: 20px;
            border-radius: 10px;
            color: #e0e0e0;
            line-height: 1.7;
        }
        .personality-text h2 {
            color: #FFD700; /* Gold for titles in personality */
            font-size: 1.5em;
            margin-bottom: 15px;
            text-align: center;
        }
        .personality-text h3 {
            color: #ffa500; /* Orange for subheadings */
            font-size: 1.2em;
            margin-top: 20px;
            margin-bottom: 10px;
            text-align: right;
        }
        .personality-text ul {
            list-style-type: disc;
            padding-right: 25px;
            margin-bottom: 15px;
        }
        .personality-text li {
            margin-bottom: 5px;
            color: #e0e0e0;
        }
        .positive-point {
            color: #8aff8a; /* Lighter green */
            font-weight: 600;
        }
        .negative-point {
            color: #ff8a8a; /* Lighter red */
            font-weight: 600;
        }
        .comparison-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px dashed #555;
            text-align: right;
        }
        .comparison-section label {
            font-size: 0.95em;
            color: #e0e0e0;
            display: block;
            margin-bottom: 12px;
        }
        .comparison-section select {
            width: calc(100% - 15px);
            padding: 10px 10px 10px 10px;
            border: 1px solid #555;
            border-radius: 8px;
            font-size: 0.95em;
            direction: rtl;
            background-color: #3a3a3a;
            color: #f0f0f0;
            cursor: pointer;
            margin-bottom: 15px;
        }
        .comparison-section button {
            margin-top: 15px;
            background-color: #1e90ff; /* Blue for comparison button */
        }
        .comparison-result {
            margin-top: 20px;
            background-color: #3a3a3a;
            border: 1px solid #555;
            border-radius: 10px;
            padding: 20px;
            text-align: right;
        }
        .comparison-result h3 {
            font-size: 1.2em;
            color: #FFD700; /* Gold */
            margin-bottom: 15px;
            text-align: center;
        }
        .comparison-result p {
            font-size: 0.95em;
            line-height: 1.7;
            color: #e0e0e0;
            margin-bottom: 10px;
        }

        /* --- Loan/Deposit Calculator Specific Styles --- */
        .tab-buttons {
            display: flex;
            justify-content: center;
            margin-bottom: 25px;
            border-bottom: 1px solid #555;
            padding-bottom: 10px;
        }
        .tab-button {
            background-color: #3a3a3a;
            border: 1px solid #555;
            padding: 10px 18px;
            cursor: pointer;
            font-size: 0.95em;
            border-radius: 8px 8px 0 0;
            margin: 0 3px;
            transition: all 0.2s ease;
            color: #e0e0e0;
        }
        .tab-button.active {
            background-color: #800080; /* Purple */
            color: white;
            border-color: #800080;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
        }
        .loan-deposit-content {
            display: none;
        }
        .toggle-switch {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            background-color: #3a3a3a;
            border-radius: 8px;
            padding: 10px 15px;
            border: 1px solid #555;
        }
        .toggle-switch span {
            font-size: 0.95em;
            color: #e0e0e0;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 45px;
            height: 25px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #666;
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 25px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 19px;
            width: 19px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #800080; /* Purple */
        }
        input:focus + .slider {
            box-shadow: 0 0 1px #800080;
        }
        input:checked + .slider:before {
            -webkit-transform: translateX(20px);
            -ms-transform: translateX(20px);
            transform: translateX(20px);
        }

        /* --- Specific Form Colors --- */

        /* Gold Calculator */
        #goldCalculator h1 { color: #FFD700; }
        #goldCalculator .input-group input:focus { border-color: #FFD700; box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.3); }
        #goldCalculator button { background-color: #FFD700; color: #333; }
        #goldCalculator button:hover { background-color: #e6c200; }
        #goldCalculator .result span { color: #FFD700; }

        /* BMI Calculator */
        #bmiCalculator h1 { color: #28a745; }
        #bmiCalculator .input-group input:focus { border-color: #28a745; box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.3); }
        #bmiCalculator button { background-color: #28a745; }
        #bmiCalculator button:hover { background-color: #218838; }
        #bmiCalculator .result span { color: #28a745; }

        /* Personality Test */
        #personalityTest h1 { color: #FFA500; }
        #personalityTest .input-group input:focus,
        #personalityTest .input-group select:focus { border-color: #FFA500; box-shadow: 0 0 0 3px rgba(255, 165, 0, 0.3); }
        #personalityTest button { background-color: #FFA500; }
        #personalityTest button:hover { background-color: #e69500; }
        #personalityTest .result span { color: #FFA500; }
        #personalityTest .comparison-section button { background-color: #1e90ff; }
        #personalityTest .comparison-section button:hover { background-color: #1a7ae0; }

        /* Loan/Deposit Calculator */
        #loanDepositCalculator h1 { color: #800080; } /* Purple */
        #loanDepositCalculator .input-group input:focus,
        #loanDepositCalculator .input-group select:focus { border-color: #800080; box-shadow: 0 0 0 3px rgba(128, 0, 128, 0.3); }
        #loanDepositCalculator button { background-color: #800080; }
        #loanDepositCalculator button:hover { background-color: #6a006a; }
        #loanDepositCalculator .result span { color: #800080; }

        /* Currency Converter */
        #currencyConverter h1 { color: #1e90ff; } /* Dodger Blue */
        #currencyConverter .input-group input:focus,
        #currencyConverter .input-group select:focus { border-color: #1e90ff; box-shadow: 0 0 0 3px rgba(30, 144, 255, 0.3); }
        #currencyConverter button { background-color: #1e90ff; }
        #currencyConverter button:hover { background-color: #1a7ae0; }
        #currencyConverter .result span { color: #1e90ff; }

        /* Hypothetical Services Calculator */
        #hypotheticalServicesCalculator h1 { color: #dc3545; } /* Red */
        #hypotheticalServicesCalculator .input-group input:focus { border-color: #dc3545; box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.3); }
        #hypotheticalServicesCalculator button { background-color: #dc3545; }
        #hypotheticalServicesCalculator button:hover { background-color: #c82333; }
        #hypotheticalServicesCalculator .result span { color: #dc3545; }
        #hypotheticalServicesCalculator .category-item {
            font-weight: bold;
            color: #FFD700; /* Gold for category names */
            margin-bottom: 8px;
        }
        #hypotheticalServicesCalculator .category-range {
            font-size: 0.85em;
            color: #aaa;
            margin-right: 5px;
            font-weight: normal;
        }
        #hypotheticalServicesCalculator ul {
            text-align: right;
            list-style-type: none; /* No default bullet */
            padding-right: 0;
            margin-top: 15px;
            color: #f0f0f0;
            font-size: 0.95em;
        }
        #hypotheticalServicesCalculator ul li {
            margin-bottom: 10px;
            position: relative;
            padding-right: 20px; /* Space for custom bullet */
        }
        #hypotheticalServicesCalculator ul li::before {
            content: "•"; /* Custom bullet point */
            color: #FFD700; /* Gold bullet */
            position: absolute;
            right: 0;
            top: 0;
            font-size: 1.2em;
        }
        #hypotheticalServicesCalculator .comparison-title {
            color: #1e90ff; /* Blue for comparison title */
            font-size: 1.1em;
            margin-top: 25px;
            margin-bottom: 10px;
            font-weight: 700;
        }
        .food-comparison-list {
            list-style-type: none;
            padding-right: 0;
            margin-top: 10px;
        }
        .food-comparison-list li {
            font-size: 0.9em;
            color: #ccc;
            margin-bottom: 8px;
            line-height: 1.5;
            position: relative;
            padding-right: 18px;
        }
        .food-comparison-list li::before {
            content: "•";
            color: #28a745; /* Green bullet for food */
            position: absolute;
            right: 0;
            top: 0;
            font-size: 1.1em;
        }
        .food-comparison-list strong {
            color: #eee;
        }
        .suggestion-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px dashed #555;
            text-align: right;
        }
        .suggestion-section h3 {
            color: #FFA500; /* Orange for suggestion titles */
            font-size: 1.3em;
            margin-bottom: 15px;
            text-align: center;
        }
        .suggestion-section p {
            font-size: 0.95em;
            line-height: 1.8;
            color: #e0e0e0;
            margin-bottom: 10px;
        }
        .suggestion-section ul {
            list-style-type: disc;
            padding-right: 25px;
            margin-bottom: 15px;
        }
        .suggestion-section li {
            margin-bottom: 8px;
            color: #e0e0e0;
        }
        .suggestion-section .highlight {
            color: #8aff8a;
            font-weight: 700;
        }

        /* Styles for the new detailed activity table */
        .activity-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            text-align: right;
            direction: rtl; /* Ensure table content is RTL */
        }
        .activity-table th, .activity-table td {
            border: 1px solid #555;
            padding: 10px;
            font-size: 0.9em;
            color: #f0f0f0;
        }
        .activity-table th {
            background-color: #4a4a4a;
            color: #FFD700; /* Gold for table headers */
            font-weight: 700;
            text-align: center;
        }
        .activity-table td {
            background-color: #3a3a3a;
        }
        .activity-table td:first-child { /* Activity Name */
            font-weight: 600;
            color: #FFA500; /* Orange for activity names */
        }
        .total-cost-row {
            font-weight: 700;
            background-color: #2a2a2a;
            color: #8aff8a !important; /* Green for total cost */
        }
        .total-cost-row td {
            color: #8aff8a !important; /* Green for total cost cells */
        }
        .balance-summary {
            margin-top: 20px;
            padding: 15px;
            background-color: #3a3a3a;
            border-radius: 10px;
            border: 1px solid #555;
            font-size: 1em;
            font-weight: 600;
            text-align: center;
            color: #f0f0f0;
        }
        .balance-summary .positive-balance {
            color: #8aff8a; /* Green for surplus */
        }
        .balance-summary .negative-balance {
            color: #ff8a8a; /* Red for deficit */
        }
        .balance-recommendation {
            margin-top: 20px;
            padding: 15px;
            background-color: #3a3a3a;
            border-radius: 10px;
            border: 1px dashed #555;
            text-align: justify;
            line-height: 1.7;
            color: #e0e0e0;
        }
        .balance-recommendation h4 {
            color: #FFA500;
            font-size: 1.1em;
            margin-bottom: 10px;
            text-align: center;
        }
        .balance-recommendation ul {
            list-style-type: disc;
            padding-right: 25px;
            margin-bottom: 15px;
        }
        .balance-recommendation li {
            margin-bottom: 5px;
            color: #e0e0e0;
        }

        /* Salawat Counter Specific Styles */
        #salawatCounter h1 {
            color: #006400; /* Dark Green */
            font-size: 2em;
            margin-bottom: 30px;
        }
        #salawatCount {
            font-size: 3.5em; /* Large number */
            font-weight: 800;
            color: #FFD700; /* Gold */
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        #salawatButton {
            background-color: #228B22; /* Forest Green */
            border-radius: 50%; /* Make it round */
            width: 180px; /* Large button */
            height: 180px; /* Large button */
            font-size: 1.8em;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 30px auto;
            border: 5px solid #006400; /* Darker border */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
            transition: all 0.2s ease;
        }
        #salawatButton:active {
            transform: scale(0.95);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
        }
        #salawatButton:hover {
            background-color: #27ae60; /* Slightly lighter green on hover */
            cursor: pointer;
        }
        #encouragementMessage {
            font-size: 1.3em;
            color: #8aff8a; /* Lighter green */
            margin-top: 20px;
            height: 30px; /* Reserve space */
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        #salawatTargetGroup {
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px dashed #555;
        }
        #salawatTargetGroup label {
            color: #e0e0e0;
            margin-bottom: 10px;
            font-size: 0.95em;
        }
        #salawatTargetInput {
            width: calc(100% - 30px);
            padding: 10px 15px;
            border: 1px solid #555;
            border-radius: 8px;
            font-size: 1em;
            background-color: #3a3a3a;
            color: #f0f0f0;
            text-align: center;
            direction: ltr;
        }
        #salawatTargetInput:focus {
            outline: none;
            border-color: #006400;
            box-shadow: 0 0 0 3px rgba(0, 100, 0, 0.3);
        }
        #targetReachedMessage {
            font-size: 1.4em;
            color: #FFD700;
            margin-top: 20px;
            font-weight: bold;
            display: none;
        }

        /* Media Queries for Responsiveness */
        @media (max-width: 768px) {
            .navbar {
                padding: 8px;
                max-width: 100%;
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }
            .nav-button {
                margin: 4px;
                flex-basis: calc(50% - 8px); /* Two buttons per row with gap */
                min-width: unset;
                font-size: 0.85em;
                padding: 10px 15px;
            }
            .app-container {
                padding: 20px;
                max-width: 380px;
            }
            .input-group input[type="number"],
            .input-group input[type="text"],
            .input-group select {
                width: calc(100% - 30px);
                padding: 10px 10px 10px 30px;
            }
            .input-group .icon {
                left: 8px;
                font-size: 1em;
                transform: translateY(calc(-50% + 10px));
            }
            .input-group select {
                padding-left: 8px;
            }
            .personality-text {
                font-size: 0.95em;
                padding: 15px;
            }
            .tab-button {
                font-size: 0.9em;
                padding: 8px 12px;
            }
            #salawatButton {
                width: 150px;
                height: 150px;
                font-size: 1.5em;
            }
            #salawatCount {
                font-size: 3em;
            }
        }

        @media (max-width: 480px) {
            .nav-button {
                flex-basis: calc(100% - 8px); /* One button per row on very small screens */
            }
            .flex-inputs {
                flex-direction: column;
                gap: 15px;
            }
            .flex-inputs .input-group {
                width: 100%;
            }
            .activity-table th, .activity-table td {
                font-size: 0.8em;
                padding: 8px 5px;
            }
            #salawatButton {
                width: 120px;
                height: 120px;
                font-size: 1.2em;
            }
            #salawatCount {
                font-size: 2.5em;
            }
            #encouragementMessage {
                font-size: 1.1em;
            }
        }
    </style>
</head>
<body>
    <h3 style="margin-bottom: 25px; color: #f0f0f0;">بسم الله الرحمن الرحیم</h3>
    
    <div class="navbar">
        <button class="nav-button" data-color="gold" onclick="showSection('goldCalculator', this)"><i class="fas fa-gem"></i><span>قیمت طلا</span></button>
        <button class="nav-button" data-color="green" onclick="showSection('bmiCalculator', this)"><i class="fas fa-calculator"></i><span>شاخص وزن</span></button>
        <button class="nav-button" data-color="orange" onclick="showSection('personalityTest', this)"><i class="fas fa-brain"></i><span>تست شخصیت</span></button>
        <button class="nav-button" data-color="purple" onclick="showSection('loanDepositCalculator', this)"><i class="fas fa-university"></i><span>سود/وام</span></button>
        <button class="nav-button" data-color="blue" onclick="showSection('currencyConverter', this)"><i class="fas fa-exchange-alt"></i><span>مبدل ارز</span></button>
        <button class="nav-button" data-color="red" onclick="showSection('hypotheticalServicesCalculator', this)"><i class="fas fa-heart"></i><span>شاخص لذت</span></button>
        <button class="nav-button" data-color="darkgreen" onclick="showSection('salawatCounter', this)"><i class="fas fa-pray"></i><span>صلوات شمار</span></button>
    </div>

    
    <div id="goldCalculator" class="app-container">
        <h1><i class="fas fa-gem" style="margin-left: 10px;"></i>محاسبه‌گر هوشمند طلا</h1>
        
        <div class="input-group">
            <label for="goldPriceToman">قیمت روز طلا (تومان در گرم):</label>
            <input type="number" id="goldPriceToman" placeholder="مثال: 3,200,000" min="0">
            <i class="fas fa-coins icon"></i>
        </div>

        <div class="input-group">
            <label for="usdExchangeRate">نرخ برابری دلار به تومان:</label>
            <input type="number" id="usdExchangeRate" placeholder="مثال: 60000" min="1000">
            <i class="fas fa-dollar-sign icon"></i>
            <small>نرخ هر دلار چند تومان است.</small>
        </div>

        <div class="input-group">
            <label>وزن طلا:</label>
            <div class="flex-inputs">
                <div class="input-group">
                    <input type="number" id="goldWeightGram" placeholder="گرم" min="0" step="any">
                    <i class="fas fa-weight-hanging icon"></i>
                </div>
                <div class="input-group">
                    <input type="number" id="goldWeightSoot" placeholder="سوت (تا 999)" min="0" max="999" step="any">
                    <i class="fas fa-balance-scale icon"></i>
                </div>
            </div>
            <small>هر گرم ۱۰۰۰ سوت است. می‌توانید فقط گرم یا سوت را وارد کنید.</small>
        </div>
        
        <div class="input-group">
            <label for="wagePercent">درصد اجرت کار (اختیاری):</label>
            <input type="number" id="wagePercent" placeholder="مثال: 20 (فقط عدد)" min="0" max="100">
            <i class="fas fa-percent icon"></i>
            <small>اگر اجرت ندارد، این فیلد را خالی بگذارید یا ۰ وارد کنید.</small>
        </div>
        
        <button onclick="calculateGoldPrice()">محاسبه قیمت</button>
        
        <div class="result" id="goldResultDiv">
            <div><span>قیمت نهایی:</span> <span id="finalPriceToman"></span> تومان</div>
            <div><span>قیمت نهایی:</span> <span id="finalPriceDollar"></span> دلار</div>
        </div>
    </div>

    
    <div id="bmiCalculator" class="app-container">
        <h1><i class="fas fa-calculator" style="margin-left: 10px;"></i>محاسبه شاخص توده بدنی (BMI)</h1>
        
        <div class="input-group">
            <label for="weight">وزن (کیلوگرم):</label>
            <input type="number" id="weight" placeholder="مثال: 70" min="1" step="any">
            <i class="fas fa-weight icon"></i>
        </div>
        
        <div class="input-group">
            <label for="height">قد (متر):</label>
            <input type="number" id="height" placeholder="مثال: 1.75" min="0.1" step="0.01">
            <i class="fas fa-ruler-vertical icon"></i>
            <small>مثال: ۱۷۵ سانتی‌متر را ۱.۷۵ متر وارد کنید.</small>
        </div>
        
        <button onclick="calculateBMI()">محاسبه BMI</button>
        
        <div class="result" id="bmiResultDiv">
            <div><span>شاخص BMI شما:</span> <span id="bmiValue"></span></div>
            <div><span>وضعیت:</span> <span id="bmiStatus"></span></div>
        </div>
    </div>

    
    <div id="personalityTest" class="app-container">
        <h1><i class="fas fa-brain" style="margin-left: 10px;"></i>تست شخصیت‌شناسی</h1>

        <div class="input-group">
            <label for="userBirthMonth">ماه تولد شما:</label>
            <select id="userBirthMonth"></select>
            <i class="fas fa-calendar-star icon"></i>
        </div>

        <div class="input-group">
            <label for="userGender">جنسیت شما:</label>
            <select id="userGender">
                <option value="">انتخاب کنید</option>
                <option value="مرد">مرد</option>
                <option value="زن">زن</option>
                <option value="دیگر">دیگر</option>
            </select>
            <i class="fas fa-venus-mars icon"></i>
        </div>

        <button onclick="analyzePersonality()">تحلیل شخصیت</button>

        <div class="result" id="personalityResultDiv">
            <div class="personality-text" id="personalityText"></div>
            <div class="comparison-section">
                <label for="compareMonth">مقایسه با متولدین ماه:</label>
                <select id="compareMonth"></select>
                <button onclick="comparePersonalities()">مقایسه شخصیت‌ها</button>
                <div class="result comparison-result" id="comparisonResultDiv">
                    <div id="comparisonText"></div>
                </div>
            </div>
        </div>
    </div>

    
    <div id="loanDepositCalculator" class="app-container">
        <h1><i class="fas fa-university" style="margin-left: 10px;"></i>محاسبه‌گر بانکی</h1>
        
        <div class="tab-buttons">
            <button class="tab-button active" onclick="showLoanDepositTab('deposit', this)">سود سپرده</button>
            <button class="tab-button" onclick="showLoanDepositTab('loan', this)">اقساط وام</button>
        </div>

        
        <div id="depositContent" class="loan-deposit-content" style="display: block;">
            <div class="input-group">
                <label for="depositAmount">مبلغ سپرده (تومان):</label>
                <input type="number" id="depositAmount" placeholder="مثال: 100,000,000" min="0">
                <i class="fas fa-money-bill-wave icon"></i>
            </div>
            <div class="input-group">
                <label for="depositInterestRate">نرخ سود سالانه (درصد):</label>
                <input type="number" id="depositInterestRate" placeholder="مثال: 18" min="0" max="100" step="0.1">
                <i class="fas fa-percent icon"></i>
            </div>

            <div class="toggle-switch">
                <span>محاسبه سود روزشمار؟</span>
                <label class="switch">
                    <input type="checkbox" id="dailyInterestToggle">
                    <span class="slider"></span>
                </label>
            </div>

            <div class="input-group">
                <label for="depositDurationDays" id="depositDurationLabel">مدت زمان سپرده (ماه):</label>
                <input type="number" id="depositDurationDays" placeholder="مثال: 12" min="1">
                <i class="fas fa-calendar-alt icon"></i>
            </div>

            <button onclick="calculateDepositInterest()">محاسبه سود سپرده</button>
            <div class="result" id="depositResultDiv">
                <div><span>سود کل:</span> <span id="totalDepositInterest"></span> تومان</div>
                <div><span>مبلغ نهایی با سود:</span> <span id="finalDepositAmount"></span> تومان</div>
            </div>
        </div>

        
        <div id="loanContent" class="loan-deposit-content">
            <div class="input-group">
                <label for="loanAmount">مبلغ وام (تومان):</label>
                <input type="number" id="loanAmount" placeholder="مثال: 50,000,000" min="0">
                <i class="fas fa-money-check-alt icon"></i>
            </div>
            <div class="input-group">
                <label for="loanInterestRate">نرخ سود سالانه (درصد):</label>
                <input type="number" id="loanInterestRate" placeholder="مثال: 23" min="0" max="100" step="0.1">
                <i class="fas fa-percent icon"></i>
            </div>
            <div class="input-group">
                <label for="loanDurationMonths">مدت بازپرداخت (ماه):</label>
                <input type="number" id="loanDurationMonths" placeholder="مثال: 60" min="1">
                <i class="fas fa-calendar-check icon"></i>
            </div>
            <button onclick="calculateLoanInstallment()">محاسبه اقساط وام</button>
            <div class="result" id="loanResultDiv">
                <div><span>مبلغ هر قسط:</span> <span id="monthlyInstallment"></span> تومان</div>
                <div><span>کل سود پرداختی:</span> <span id="totalLoanInterest"></span> تومان</div>
                <div><span>مجموع پرداختی:</span> <span id="totalPayment"></span> تومان</div>
            </div>
        </div>
    </div>

    
    <div id="currencyConverter" class="app-container">
        <h1><i class="fas fa-exchange-alt" style="margin-left: 10px;"></i>مبدل ارز</h1>
        
        <div class="input-group">
            <label for="amountToConvert">مبلغ:</label>
            <input type="number" id="amountToConvert" placeholder="مثال: 100" min="0">
            <i class="fas fa-money-bill-wave icon"></i>
        </div>
        
        <div class="input-group">
            <label for="fromCurrency">از واحد:</label>
            <select id="fromCurrency"></select>
            <i class="fas fa-chevron-circle-down icon"></i>
        </div>

        <div class="input-group">
            <label for="toCurrency">به واحد:</label>
            <select id="toCurrency"></select>
            <i class="fas fa-chevron-circle-down icon"></i>
        </div>

        <div class="input-group" id="exchangeRateInputGroup">
            <label for="exchangeRate">نرخ تبدیل (1 <span id="fromCurrencySymbol"></span> = ? <span id="toCurrencySymbol"></span>):</label>
            <input type="number" id="exchangeRate" placeholder="مثال: 60000 (برای دلار به تومان)" min="0" step="any">
            <i class="fas fa-coins icon"></i>
            <small>نرخ تبدیل ارز مبدأ به ارز مقصد را وارد کنید.</small>
        </div>
        
        <button onclick="convertCurrency()">تبدیل ارز</button>
        
        <div class="result" id="currencyResultDiv">
            <div><span>مبلغ تبدیل شده:</span> <span id="convertedAmount"></span></div>
        </div>
    </div>

    
    <div id="hypotheticalServicesCalculator" class="app-container">
        <h1><i class="fas fa-heart" style="margin-left: 10px;"></i>شاخص لذت</h1>
        
        <div class="input-group">
            <label for="dollarExchangeRateHypothetical">نرخ روز دلار به تومان:</label>
            <input type="number" id="dollarExchangeRateHypothetical" placeholder="مثال: 60000" min="1000">
            <i class="fas fa-dollar-sign icon"></i>
            <small>نرخ هر دلار چند تومان است.</small>
        </div>

        <div class="input-group">
            <label for="hypotheticalBudget">درآمد ماهیانه شما (تومان):</label>
            <input type="number" id="hypotheticalBudget" placeholder="مثال: 15,000,000" min="0">
            <i class="fas fa-coins icon"></i>
        </div>

        <div class="input-group">
            <label for="userAge">سن شما:</label>
            <input type="number" id="userAge" placeholder="مثال: 30" min="10" max="100">
            <i class="fas fa-user icon"></i>
        </div>

        <div class="input-group">
            <label for="userOccupation">شغل شما:</label>
            <select id="userOccupation">
                <option value="">انتخاب کنید</option>
                <option value="کارمند">کارمند</option>
                <option value="معلم">معلم</option>
                <option value="دانشجو">دانشجو</option>
                <option value="آزادکار/فریلنسر">آزادکار/فریلنسر</option>
                <option value="پزشک/پرستار">پزشک/پرستار</option>
                <option value="مهندس">مهندس</option>
                <option value="راننده">راننده</option>
                <option value="فروشنده">فروشنده</option>
                <option value="کارگر">کارگر</option>
                <option value="خانهدار">خانه‌دار</option>
                <option value="بازنشسته">بازنشسته</option>
                <option value="کشاورز">کشاورز</option>
                <option value="معمار">معمار</option>
                <option value="برنامهنویس">برنامه‌نویس</option>
                <option value="وکیل">وکیل</option>
                <option value="هنرمند">هنرمند</option>
                <option value="مدیر">مدیر</option>
                <option value="سرباز/نظامی">سرباز/نظامی</option>
                <option value="صنعتگر">صنعتگر</option>
                <option value="بیکار">بیکار</option>
            </select>
            <i class="fas fa-briefcase icon"></i>
        </div>

        <div class="input-group">
            <label for="maritalStatus">وضعیت تأهل:</label>
            <select id="maritalStatus">
                <option value="">انتخاب کنید</option>
                <option value="مجرد">مجرد</option>
                <option value="متاهل">متأهل</option>
            </select>
            <i class="fas fa-ring icon"></i>
        </div>

        <div class="input-group" id="childrenCountGroup" style="display: none;">
            <label for="childrenCount">تعداد فرزندان:</label>
            <input type="number" id="childrenCount" placeholder="مثال: 1" min="0">
            <i class="fas fa-child icon"></i>
        </div>

        <div class="input-group">
            <label for="livingArea">محل زندگی:</label>
            <select id="livingArea">
                <option value="">انتخاب کنید</option>
                <option value="شهری">شهری</option>
                <option value="روستایی">روستایی</option>
            </select>
            <i class="fas fa-city icon"></i>
        </div>

        <div class="input-group">
            <label for="houseOwnership">وضعیت سکونت:</label>
            <select id="houseOwnership">
                <option value="">انتخاب کنید</                <option value="مالک">صاحب‌خانه</option>
                <option value="مستاجر">مستأجر</option>
            </select>
            <i class="fas fa-home icon"></i>
        </div>

        <div class="input-group">
            <label for="carOwnership">مالکیت خودرو:</label>
            <select id="carOwnership">
                <option value="">انتخاب کنید</option>
                <option value="دارم">دارم</option>
                <option value="ندارم">ندارم</option>
            </select>
            <i class="fas fa-car icon"></i>
        </div>
        
        <button onclick="calculateHypotheticalServices()">تحلیل بودجه لذت</button>
        
        <div class="result" id="hypotheticalServicesResultDiv">
            <div class="suggestion-section" id="budgetSuggestion">
                <h3></h3>
                <p></p>
                <table class="activity-table" id="activityTable">
                    <thead>
                        <tr>
                            <th>نوع فعالیت</th>
                            <th>تعداد/دفعات (ماهیانه)</th>
                            <th>هزینه حدودی (تومان)</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                    <tfoot>
                        <tr class="total-cost-row">
                            <td colspan="2">هزینه کل پیشنهادی تفریح و فعالیت (ماهیانه):</td>
                            <td id="totalActivityCost"></td>
                        </tr>
                    </tfoot>
                </table>
                <p style="margin-top: 20px; font-size: 0.9em; color: #bbb;">
                    *هزینه‌های فوق تقریبی بوده و ممکن است بر اساس منطقه جغرافیایی، کیفیت و نوسانات بازار متفاوت باشند.*
                </p>
            </div>

            <div class="balance-summary" id="balanceSummary">
                </div>

            <div class="balance-recommendation" id="balanceRecommendation">
                </div>

            <div style="margin-top: 25px; padding-top: 15px; border-top: 1px dashed #555;">
                <p style="font-size: 0.9em; color: #aaa; text-align: center; line-height: 1.6;">
                    برای رسیدن به اهداف مالی بزرگ‌تر و تجربه‌ی لذت‌های پایدارتر در زندگی، می‌توانید بخشی از این بودجه را به **سرمایه‌گذاری یا پس‌انداز** اختصاص دهید. این مسیر به شما کمک می‌کند تا در بلندمدت، زندگی رضایت‌بخش‌تری را تجربه کنید.
                </p>
            </div>
        </div>
    </div>

    <div id="salawatCounter" class="app-container">
        <h1><i class="fas fa-pray" style="margin-left: 10px;"></i>صلوات شمار</h1>

        <div id="salawatCount">0</div>

        <button id="salawatButton" onclick="incrementSalawat()">
            <i class="fas fa-hand-pointer"></i> صلوات
        </button>

        <div id="encouragementMessage"></div>

        <div class="input-group" id="salawatTargetGroup">
            <label for="salawatTargetInput">هدف صلوات (اختیاری):</label>
            <input type="number" id="salawatTargetInput" placeholder="مثال: 1000" min="0">
            <i class="fas fa-bullseye icon"></i>
        </div>
        
        <div id="targetReachedMessage">تبریک! به هدف صلوات خود رسیدید!</div>
    </div>
    
    <script>
        // --- Navigation Logic (Concise) ---
        function showSection(sectionId, clickedButton) {
            document.querySelectorAll('.app-container').forEach(s => s.style.display = 'none');
            document.querySelectorAll('.nav-button').forEach(b => b.classList.remove('active'));
            document.getElementById(sectionId).style.display = 'block';
            clickedButton.classList.add('active');
            document.querySelectorAll('.result').forEach(r => r.style.display = 'none');
            // Reset Salawat counter when switching sections
            if (sectionId !== 'salawatCounter') {
                salawatCount = 0;
                document.getElementById('salawatCount').innerText = 0;
                document.getElementById('salawatButton').disabled = false;
                document.getElementById('encouragementMessage').style.opacity = 0;
                document.getElementById('targetReachedMessage').style.display = 'none';
            }
            if (sectionId === 'personalityTest') { populatePersonalityMonths(); populateCompareMonths(); }
            if (sectionId === 'loanDepositCalculator') { showLoanDepositTab('deposit', document.querySelector('#loanDepositCalculator .tab-buttons .tab-button:first-child')); }
            if (sectionId === 'currencyConverter') { populateCurrencies(); updateExchangeRateLabels(); }
        }

        // --- Gold Calculator Logic (Concise) ---
        function calculateGoldPrice() {
            const [goldPrice, usdRate, goldGram, goldSoot, wage] = 
                ['goldPriceToman', 'usdExchangeRate', 'goldWeightGram', 'goldWeightSoot', 'wagePercent']
                .map(id => parseFloat(document.getElementById(id).value) || 0);

            if (!goldPrice || !usdRate || (goldGram + goldSoot <= 0)) { alert('لطفاً تمامی فیلدهای الزامی را پر کنید.'); return; }

            const totalWeight = goldGram + (goldSoot / 1000);
            const wageAmount = (goldPrice * (wage / 100)) * totalWeight;
            const profitAmount = (goldPrice * 0.07) * totalWeight;
            const taxAmount = (wageAmount + profitAmount) * 0.10;
            const finalPriceToman = (goldPrice * totalWeight) + wageAmount + profitAmount + taxAmount;
            const finalPriceDollar = finalPriceToman / usdRate;

            document.getElementById('finalPriceToman').innerText = finalPriceToman.toLocaleString('fa-IR');
            document.getElementById('finalPriceDollar').innerText = finalPriceDollar.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            document.getElementById('goldResultDiv').style.display = 'block';
        }

        // --- BMI Calculator Logic (Concise) ---
        function calculateBMI() {
            const [weight, height] = ['weight', 'height'].map(id => parseFloat(document.getElementById(id).value));

            if (!weight || !height) { alert('لطفاً وزن و قد را به درستی وارد کنید.'); return; }

            const bmi = weight / (height * height);
            let status = bmi < 18.5 ? 'کم‌وزنی' : bmi <= 24.9 ? 'وزن نرمال' : bmi <= 29.9 ? 'اضافه‌وزن' : bmi <= 34.9 ? 'چاقی (درجه ۱)' : bmi <= 39.9 ? 'چاقی شدید (درجه ۲)' : 'چاقی مفرط (درجه ۳)';

            document.getElementById('bmiValue').innerText = bmi.toLocaleString('fa-IR', { minimumFractionDigits: 1, maximumFractionDigits: 1 });
            document.getElementById('bmiStatus').innerText = status;
            document.getElementById('bmiResultDiv').style.display = 'block';
        }

        // --- Personality Test Logic (Concise) ---
        const solarMonths = [
            { value: 'فروردین', text: 'فروردین (حمل)' }, { value: 'اردیبهشت', text: 'اردیبهشت (ثور)' },
            { value: 'خرداد', text: 'خرداد (جوزا)' }, { value: 'تیر', text: 'تیر (سرطان)' },
            { value: 'مرداد', text: 'مرداد (اسد)' }, { value: 'شهریور', text: 'شهریور (سنبله)' },
            { value: 'مهر', text: 'مهر (میزان)' }, { value: 'آبان', text: 'آبان (عقرب)' },
            { value: 'آذر', text: 'آذر (قوس)' }, { value: 'دی', text: 'دی (جدی)' },
            { value: 'بهمن', text: 'بهمن (دلو)' }, { value: 'اسفند', text: 'اسفند (حوت)' }
        ];

        const personalityTraits = {
            'فروردین': { 'قوت': ["شروعکننده", "خلاق", "اجتماعی", "خوشبین", "کنجکاو", "آزاداندیش"], 'ضعف': ["زود خسته", "بینظم", "سطحی", "عجول", "غیرواقعبین", "مسئولیتگریز"] },
            'اردیبهشت': { 'قوت': ["منظم", "وفادار", "صبور", "واقعبین", "سختکوش", "محافظهکار"], 'ضعف': ["سختگیر", "مقاوم به تغییر", "مادیگرا", "کینهتوز", "خشک", "انعطافناپذیر"] },
            'خرداد': { 'قوت': ["کنجکاو", "سازگار", "شوخطبع", "همدل", "اجتماعی", "مثبتاندیش"], 'ضعف': ["پرحرف", "بیقرار", "سطحینگر", "فراموشکار", "زود بیعلاقه", "غیرقابل پیشبینی"] },
            'تیر': { 'قوت': ["عاطفی", "خانوادهدوست", "خلاق", "وفادار", "غریزه قوی", "عمیق"], 'ضعف': ["حساس", "وابسته", "کمالگرا", "احساساتی", "غیرتی", "درونگرا"] },
            'مرداد': { 'قوت': ["قوی", "رهبر", "صریح", "متعهد", "مسئولیتپذیر", "جاهطلب"], 'ضعف': ["مغرور", "سلطهجو", "کینهتوز", "سختگیر", "انعطافناپذیر", "فشارآور"] },
            'شهریور': { 'قوت': ["منظم", "کوشا", "عملی", "وفادار", "انتقادپذیر", "مسئولیتپذیر"], 'ضعف': ["کمالگرا", "ایرادگیر", "محافظهکار", "منتقد", "سختگیر", "وسواس"] },
            'مهر': { 'قوت': ["منصف", "دیپلماتیک", "جذاب", "اجتماعی", "انعطافپذیر", "رمانتیک"], 'ضعف': ["تودار", "مردد", "وابسته", "فرار از تعارض", "سطحی", "سازشکار"] },
            'آبان': { 'قوت': ["مرموز", "شهودی", "پرشور", "مصمم", "وفادار", "رازدار"], 'ضعف': ["کینهتوز", "کنترلگر", "بدبین", "افراطی", "انعطافناپذیر", "پنهانکار"] },
            'آذر': { 'قوت': ["ماجراجو", "خوشبین", "صادق", "اجتماعی", "انعطافپذیر", "انرژیبخش"], 'ضعف': ["بیتعهد", "سطحینگر", "فراموشکار", "غیرقابل پیشبینی", "بیخیال", "عدم پایداری"] },
            'دی': { 'قوت': ["جدی", "منضبط", "صبور", "سختکوش", "وفادار", "محکم"], 'ضعف': ["سرد", "یکدنده", "ترسو", "منتقد", "خشک", "فشارآور"] },
            'بهمن': { 'قوت': ["خلاق", "انقلابی", "بشردوست", "کنجکاو", "متعهد", "مرموز"], 'ضعف': ["غیرقابل پیشبینی", "سرسخت", "غیرمنطقی", "افراطی", "کمتحمل", "منزوی"] },
            'اسفند': { 'قوت': ["خیالپرداز", "حساس", "رمانتیک", "مهربان", "شهودی", "انعطافپذیر"], 'ضعف': ["زودرنج", "غیرواقعبین", "غیرقابل پیشبینی", "فراموشکار", "وابسته", "منزوی"] }
        };

        const getRandomElements = (arr, count) => arr.sort(() => 0.5 - Math.random()).slice(0, count);

        function populatePersonalityMonths() {
            [document.getElementById('userBirthMonth'), document.getElementById('compareMonth')].forEach(select => {
                select.innerHTML = select.id === 'userBirthMonth' ? '<option value="">ماه تولد شما را انتخاب کنید</option>' : '<option value="">برای مقایسه انتخاب کنید</option>';
                solarMonths.forEach(m => select.appendChild(new Option(m.text, m.value)));
            });
        }
        const populateCompareMonths = populatePersonalityMonths; // Re-use

        function analyzePersonality() {
            const [birthMonth, gender] = ['userBirthMonth', 'userGender'].map(id => document.getElementById(id).value);
            if (!birthMonth || !gender) { alert('لطفاً ماه تولد و جنسیت خود را انتخاب کنید.'); return; }

            const traits = personalityTraits[birthMonth];
            const pos = getRandomElements(traits['قوت'], Math.floor(Math.random() * 2) + 3); // 3-4 positives
            const neg = getRandomElements(traits['ضعف'], Math.floor(Math.random() * 2) + 2); // 2-3 negatives

            const html = `<h2>شخصیت متولدین ماه ${birthMonth}</h2><h3>نقاط قوت شما:</h3><ul>${pos.map(t => `<li class="positive-point">${t}</li>`).join('')}</ul><h3>نقاط قابل بهبود شما:</h3><ul>${neg.map(t => `<li class="negative-point">${t}</li>`).join('')}</ul>`;
            document.getElementById('personalityText').innerHTML = html;
            document.getElementById('personalityResultDiv').style.display = 'block';
            document.getElementById('comparisonResultDiv').style.display = 'none';
        }

        function comparePersonalities() {
            const [userMonth, compareMonth] = ['userBirthMonth', 'compareMonth'].map(id => document.getElementById(id).value);
            if (!userMonth || !compareMonth || userMonth === compareMonth) { alert('لطفاً دو ماه متفاوت را برای مقایسه انتخاب کنید.'); return; }

            const [userT, compareT] = [personalityTraits[userMonth], personalityTraits[compareMonth]];
            const commonP = userT['قوت'].filter(t => compareT['قوت'].includes(t));
            const commonN = userT['ضعف'].filter(t => compareT['ضعف'].includes(t));
            const userUniqueP = userT['قوت'].filter(t => !compareT['قوت'].includes(t));
            const compareUniqueP = compareT['قوت'].filter(t => !userT['قوت'].includes(t));

            let html = `<h3>مقایسه شخصیت متولد ${userMonth} با متولد ${compareMonth}:</h3>`;
            html += `<p><strong>نقاط مشترک مثبت:</strong> ${commonP.length ? commonP.map(t => `<span class="positive-point">${t}</span>`).join('، ') : 'مورد قابل توجهی یافت نشد.'}</p>`;
            if (userUniqueP.length || compareUniqueP.length) {
                html += `<p><strong>نقاط قوت متفاوت:</strong></p><ul>`;
                userUniqueP.forEach(t => html += `<li>متولد ${userMonth}: ${t}</li>`);
                compareUniqueP.forEach(t => html += `<li>متولد ${compareMonth}: ${t}</li>`);
                html += `</ul>`;
            }
            html += `<p><strong>نقاط مشترک منفی (نیاز به توجه):</strong> ${commonN.length ? commonN.map(t => `<span class="negative-point">${t}</span>`).join('، ') : 'مورد قابل توجهی یافت نشد.'}</p>`;

            const compatibilityScore = commonP.length * 2 - commonN.length * 2;
            let compatibilityStatement = compatibilityScore >= 3 ? "شما و متولد این ماه شباهت‌های مثبتی زیادی دارید و احتمالاً به خوبی با هم کنار می‌آیید. تفاهم کلی شما بالاست." :
                                         compatibilityScore >= 0 ? "شما و متولد این ماه می‌توانید در بسیاری از زمینه‌ها تفاهم داشته باشید، با کمی درک متقابل و پذیرش تفاوت‌ها." :
                                         "ممکن است در برخی زمینه‌ها چالش‌هایی در تفاهم با متولد این ماه داشته باشید. نیاز به درک بیشتر از تفاوت‌ها و تلاش برای سازگاری است.";
            html += `<p><strong>نتیجه کلی تفاهم:</strong> ${compatibilityStatement}</p>`;
            document.getElementById('comparisonText').innerHTML = html;
            document.getElementById('comparisonResultDiv').style.display = 'block';
        }

        // --- Loan/Deposit Calculator Logic (Concise) ---
        function showLoanDepositTab(tabId, clickedButton) {
            document.querySelectorAll('.loan-deposit-content').forEach(c => c.style.display = 'none');
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId + 'Content').style.display = 'block';
            clickedButton.classList.add('active');
            document.getElementById('depositResultDiv').style.display = 'none';
            document.getElementById('loanResultDiv').style.display = 'none';
            if (tabId === 'deposit') { document.getElementById('depositAmount').value = ''; document.getElementById('depositInterestRate').value = ''; document.getElementById('depositDurationDays').value = ''; document.getElementById('dailyInterestToggle').checked = false; updateDepositDurationLabel(); }
            else { document.getElementById('loanAmount').value = ''; document.getElementById('loanInterestRate').value = ''; document.getElementById('loanDurationMonths').value = ''; }
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('dailyInterestToggle').addEventListener('change', updateDepositDurationLabel);
            updateDepositDurationLabel();
            // Event listener for marital status to show/hide children count
            document.getElementById('maritalStatus').addEventListener('change', function() {
                document.getElementById('childrenCountGroup').style.display = this.value === 'متاهل' ? 'block' : 'none';
            });
        });

        function updateDepositDurationLabel() {
            document.getElementById('depositDurationLabel').innerText = document.getElementById('dailyInterestToggle').checked ? 'مدت زمان سپرده (روز):' : 'مدت زمان سپرده (ماه):';
        }

        function calculateDepositInterest() {
            const [amount, rate, durationInput] = ['depositAmount', 'depositInterestRate', 'depositDurationDays'].map(id => parseFloat(document.getElementById(id).value));
            const isDaily = document.getElementById('dailyInterestToggle').checked;

            if (isNaN(amount) || amount <= 0 || isNaN(rate) || rate < 0 || isNaN(durationInput) || durationInput <= 0) { alert('لطفاً تمام فیلدها را با مقادیر صحیح وارد کنید.'); return; }

            let totalInterest, finalAmount;
            if (isDaily) {
                totalInterest = amount * (rate / 100) / 365 * durationInput;
            } else {
                totalInterest = amount * (rate / 100) / 12 * durationInput;
            }
            finalAmount = amount + totalInterest;

            document.getElementById('totalDepositInterest').innerText = totalInterest.toLocaleString('fa-IR', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
            document.getElementById('finalDepositAmount').innerText = finalAmount.toLocaleString('fa-IR', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
            document.getElementById('depositResultDiv').style.display = 'block';
        }

        function calculateLoanInstallment() {
            const [amount, rate, duration] = ['loanAmount', 'loanInterestRate', 'loanDurationMonths'].map(id => parseFloat(document.getElementById(id).value));
            if (isNaN(amount) || amount <= 0 || isNaN(rate) || rate < 0 || isNaN(duration) || duration <= 0) { alert('لطفاً تمام فیلدها را با مقادیر صحیح وارد کنید.'); return; }

            const monthlyRate = (rate / 100) / 12;
            let monthlyInstallment, totalInterest, totalPayment;

            if (monthlyRate === 0) {
                monthlyInstallment = amount / duration;
                totalInterest = 0;
                totalPayment = amount;
            } else {
                monthlyInstallment = amount * monthlyRate * Math.pow(1 + monthlyRate, duration) / (Math.pow(1 + monthlyRate, duration) - 1);
                totalPayment = monthlyInstallment * duration;
                totalInterest = totalPayment - amount;
            }
            
            document.getElementById('monthlyInstallment').innerText = monthlyInstallment.toLocaleString('fa-IR', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
            document.getElementById('totalLoanInterest').innerText = totalInterest.toLocaleString('fa-IR', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
            document.getElementById('totalPayment').innerText = totalPayment.toLocaleString('fa-IR', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
            document.getElementById('loanResultDiv').style.display = 'block';
        }

        // --- Currency Converter Logic (Concise) ---
        const currencies = [
            { name: 'ریال ایران', symbol: 'IRR' }, { name: 'دلار آمریکا', symbol: 'USD' },
            { name: 'یورو', symbol: 'EUR' }, { name: 'پوند بریتانیا', symbol: 'GBP' },
            { name: 'درهم امارات', symbol: 'AED' }, { name: 'لیر ترکیه', symbol: 'TRY' },
            { name: 'یوان چین', symbol: 'CNY' }, { name: 'روپیه هند', symbol: 'INR' },
            { name: 'ین ژاپن', symbol: 'JPY' }
        ];

        function populateCurrencies() {
            ['fromCurrency', 'toCurrency'].forEach(id => {
                const select = document.getElementById(id);
                select.innerHTML = '';
                currencies.forEach(c => select.appendChild(new Option(`${c.name} (${c.symbol})`, c.symbol)));
            });
            document.getElementById('fromCurrency').value = 'USD';
            document.getElementById('toCurrency').value = 'IRR';
            document.getElementById('fromCurrency').addEventListener('change', updateExchangeRateLabels);
            document.getElementById('toCurrency').addEventListener('change', updateExchangeRateLabels);
            updateExchangeRateLabels();
        }

        function updateExchangeRateLabels() {
            const [from, to] = ['fromCurrency', 'toCurrency'].map(id => document.getElementById(id).value);
            document.getElementById('fromCurrencySymbol').innerText = from;
            document.getElementById('toCurrencySymbol').innerText = to;
            const exRateInput = document.getElementById('exchangeRate');
            const smallText = document.querySelector('#exchangeRateInputGroup small');
            if (from === 'USD' && to === 'IRR') { exRateInput.placeholder = "مثال: 60000"; smallText.innerText = "نرخ هر دلار چند تومان است."; }
            else if (from === 'IRR' && to === 'USD') { exRateInput.placeholder = "مثال: 0.000017"; smallText.innerText = "هر تومان چند دلار است (مثال: 1/60000)."; }
            else { exRateInput.placeholder = "مثال: 12345"; smallText.innerText = "نرخ تبدیل ارز مبدأ به ارز مقصد را وارد کنید."; }
            exRateInput.value = '';
        }

        function convertCurrency() {
            const [amount, from, to, rate] = ['amountToConvert', 'fromCurrency', 'toCurrency', 'exchangeRate'].map(id => {
                const el = document.getElementById(id);
                return el.type === 'select-one' ? el.value : parseFloat(el.value);
            });

            if (isNaN(amount) || amount <= 0 || !from || !to) { alert('لطفاً تمامی فیلدهای الزامی را پر کنید.'); return; }
            if (from === to) { document.getElementById('convertedAmount').innerText = `${amount.toLocaleString('fa-IR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} ${from}`; document.getElementById('currencyResultDiv').style.display = 'block'; return; }
            if (isNaN(rate) || rate <= 0) { alert('لطفاً نرخ تبدیل را به درستی وارد کنید.'); return; }

            document.getElementById('convertedAmount').innerText = `${(amount * rate).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} ${to}`;
            document.getElementById('currencyResultDiv').style.display = 'block';
        }

        // --- Hypothetical Services Calculator Logic (Accurate & Smart) ---
        const iranianServiceCostsUSD = {
            'اجاره مسکن شهری': { min: 100, max: 500, type: 'fixed', isPerPerson: false },
            'اجاره مسکن روستایی': { min: 50, max: 100, type: 'fixed', isPerPerson: false },
            'برق (ماهیانه)': { min: 1, max: 3, type: 'fixed', isPerPerson: false },
            'آب (ماهیانه)': { min: 1, max: 1, type: 'fixed', isPerPerson: false },
            'گاز (ماهیانه)': { min: 0.5, max: 0.5, type: 'fixed', isPerPerson: false },
            'تلفن (ماهیانه)': { min: 0.2, max: 0.5, type: 'fixed', isPerPerson: false },
            'اینترنت (ماهیانه)': { min: 1, max: 2, type: 'fixed', isPerPerson: true },
            'مواد غذایی و خواربار (اقتصادی)': { min: 10, max: 10, type: 'food_item', isPerPerson: true },
            'مواد غذایی و خواربار (متوسط)': { min: 15, max: 20, type: 'food_item', isPerPerson: true },
            'مواد غذایی و خواربار (خوب)': { min: 30, max: 50, type: 'food_item', isPerPerson: true },
            'بنزین (3 لیتر)': { min: 0.1, max: 0.1, type: 'transport', isPerPerson: false },
            'کرایه تاکسی (یک سفر)': { min: 0.5, max: 1.5, type: 'transport', isPerPerson: false },
            'هزینه درمان ساده (یک بار)': { min: 3, max: 3, type: 'health', isPerPerson: false },
            'هزینه درمان متوسط (یک بار)': { min: 10, max: 20, type: 'health', isPerPerson: false },
            'هزینه درمان سنگین (یک بار)': { min: 100, max: 500, type: 'health', isPerPerson: false },
            'شلوار': { min: 10, max: 20, type: 'clothing', isPerPerson: false },
            'تی شرت و پیراهن': { min: 5, max: 15, type: 'clothing', isPerPerson: false },
            'کفش و بقیه موارد پوشاک': { min: 5, max: 15, type: 'clothing', isPerPerson: false },
            'رستوران لوکس (نفری)': { min: 6, max: 15, type: 'food', isPerPerson: true },
            'فست فود (یک وعده)': { min: 2, max: 4, type: 'food', isPerPerson: true },
            'کافه (یک بار)': { min: 0.5, max: 2, type: 'leisure', isPerPerson: true },
            'سینما (یک بلیط)': { min: 1.5, max: 1.5, type: 'leisure', isPerPerson: false },
            'باشگاه (ماهیانه)': { min: 13, max: 13, type: 'health', isPerPerson: true },
            // Added based on previous suggestions and common sense
            'تفریح سبک و رایگان (مثل پیاده‌روی)': { min: 0, max: 0, type: 'leisure', isPerPerson: false },
            'خرید یک کتاب جدید': { min: 1.5, max: 4, type: 'education', isPerPerson: false },
            'اشتراک ماهانه نرم‌افزار کاربردی': { min: 2, max: 10, type: 'education', isPerPerson: true },
            'یک بار استفاده از استخر': { min: 2, max: 4, type: 'health', isPerPerson: false },
            'کلاس آموزشی آنلاین/ورزش‌های انفرادی (ماهانه)': { min: 2, max: 10, type: 'education', isPerPerson: true },
            'مسافرت داخلی (اقتصادی، روزانه)': { min: 5, max: 10, type: 'travel', isPerPerson: false },
            'مسافرت داخلی (متوسط، روزانه)': { min: 10, max: 15, type: 'travel', isPerPerson: false },
            'مسافرت داخلی (رفاهی، روزانه)': { min: 15, max: 20, type: 'travel', isPerPerson: false },
            'هزینه حمل و نقل عمومی (ماهیانه)': { min: 3, max: 10, type: 'transport', isPerPerson: true }, // Per person cost
            'هزینه نگهداری خودرو (بنزین، استهلاک، بیمه - ماهیانه)': { min: 30, max: 100, type: 'transport', isPerPerson: false },
            'سیگار (یک پاکت)': { min: 0.5, max: 1, type: 'leisure', isPerPerson: false }, // If applicable
            'مشروب (یک بطری)': { min: 10, max: 150, type: 'leisure', isPerPerson: false } // Placeholder, if applicable
        };

        function calculateHypotheticalServices() {
            const dollarRate = parseFloat(document.getElementById('dollarExchangeRateHypothetical').value);
            const monthlyIncomeToman = parseFloat(document.getElementById('hypotheticalBudget').value);
            const userAge = parseInt(document.getElementById('userAge').value);
            const userOccupation = document.getElementById('userOccupation').value;
            const maritalStatus = document.getElementById('maritalStatus').value;
            const childrenCount = maritalStatus === 'متاهل' ? parseInt(document.getElementById('childrenCount').value) || 0 : 0;
            const livingArea = document.getElementById('livingArea').value;
            const houseOwnership = document.getElementById('houseOwnership').value;
            const carOwnership = document.getElementById('carOwnership').value;

            if (isNaN(dollarRate) || dollarRate <= 0 || isNaN(monthlyIncomeToman) || monthlyIncomeToman < 0 ||
                isNaN(userAge) || userAge <= 0 || !userOccupation || !maritalStatus || !livingArea || !houseOwnership || !carOwnership) {
                alert('لطفاً تمامی فیلدهای اطلاعات شخصی و مالی را به درستی وارد کنید.');
                return;
            }

            const numberOfPeople = maritalStatus === 'متاهل' ? (2 + childrenCount) : 1; // 1 for single, 2 for couple, + children

            const monthlyIncomeUSD = monthlyIncomeToman / dollarRate;
            let totalFixedCostsUSD = 0;
            let suggestedActivities = []; // { name: "", count: "", costUSD: "", category: "" }

            // 1. Fixed Costs / Essential Living Expenses (based on user input and general living costs)
            // Housing Cost
            if (houseOwnership === 'مستاجر') {
                let rentKey = livingArea === 'شهری' ? 'اجاره مسکن شهری' : 'اجاره مسکن روستایی';
                let baseRent = iranianServiceCostsUSD[rentKey].min;
                // Adjust rent based on income and number of people for more realism
                let adjustedRent = Math.min(iranianServiceCostsUSD[rentKey].max, Math.max(baseRent, monthlyIncomeUSD * 0.25 / (maritalStatus === 'متاهل' ? 1.5 : 1))); // Higher portion for single, less for couple
                if (childrenCount > 0) adjustedRent += childrenCount * 30; // Add for kids
                rentCostUSD = adjustedRent;
                suggestedActivities.push({ name: 'اجاره خانه (ماهیانه)', count: '۱ بار', costUSD: rentCostUSD, category: 'هزینه‌های ثابت' });
                totalFixedCostsUSD += rentCostUSD;
            }

            // Basic Utilities (not per person)
            totalFixedCostsUSD += iranianServiceCostsUSD['برق (ماهیانه)'].max;
            totalFixedCostsUSD += iranianServiceCostsUSD['آب (ماهیانه)'].max;
            totalFixedCostsUSD += iranianServiceCostsUSD['گاز (ماهیانه)'].max;
            totalFixedCostsUSD += iranianServiceCostsUSD['تلفن (ماهیانه)'].max;
            suggestedActivities.push({ name: 'آب، برق، گاز، تلفن (ماهیانه)', count: '۱ بار', costUSD: (iranianServiceCostsUSD['برق (ماهیانه)'].max + iranianServiceCostsUSD['آب (ماهیانه)'].max + iranianServiceCostsUSD['گاز (ماهیانه)'].max + iranianServiceCostsUSD['تلفن (ماهیانه)'].max), category: 'هزینه‌های ثابت' });


            // Internet (per person)
            let internetCost = iranianServiceCostsUSD['اینترنت (ماهیانه)'].max * numberOfPeople;
            totalFixedCostsUSD += internetCost;
            suggestedActivities.push({ name: 'اینترنت (ماهیانه)', count: `${numberOfPeople} نفر`, costUSD: internetCost, category: 'هزینه‌های ثابت' });

            // Food Cost (per person) - using "متوسط" as a baseline for basic needs
            let foodCost = iranianServiceCostsUSD['مواد غذایی و خواربار (متوسط)'].max * numberOfPeople;
            totalFixedCostsUSD += foodCost;
            suggestedActivities.push({ name: 'مواد غذایی و خواربار (ماهیانه)', count: `${numberOfPeople} نفر`, costUSD: foodCost, category: 'هزینه‌های ثابت' });

            // Basic Health (simple treatments, check-ups, etc. - as a recurring avg)
            let basicHealthCost = iranianServiceCostsUSD['هزینه درمان ساده (یک بار)'].max * numberOfPeople; // Assume 1-2 simple treatments per person per year
            totalFixedCostsUSD += basicHealthCost;
            suggestedActivities.push({ name: 'هزینه‌های درمانی پایه (ماهیانه)', count: '۱ بار', costUSD: basicHealthCost, category: 'هزینه‌های ثابت' });

            // Clothing (average monthly spend)
            let basicClothingCost = (iranianServiceCostsUSD['تی شرت و پیراهن'].max + iranianServiceCostsUSD['شلوار'].min) * numberOfPeople / 6; // Assume refreshing some clothes every 6 months
            totalFixedCostsUSD += basicClothingCost;
            suggestedActivities.push({ name: 'هزینه پوشاک (ماهیانه)', count: '۱ بار', costUSD: basicClothingCost, category: 'هزینه‌های ثابت' });

            // Transportation Cost
            if (carOwnership === 'دارم') {
                let carMaintenanceCost = iranianServiceCostsUSD['هزینه نگهداری خودرو (بنزین، استهلاک، بیمه - ماهیانه)'].max;
                totalFixedCostsUSD += carMaintenanceCost;
                suggestedActivities.push({ name: 'هزینه نگهداری خودرو (ماهیانه)', count: '۱ بار', costUSD: carMaintenanceCost, category: 'هزینه‌های ثابت' });
            } else {
                let publicTransportCost = iranianServiceCostsUSD['هزینه حمل و نقل عمومی (ماهیانه)'].max * numberOfPeople;
                totalFixedCostsUSD += publicTransportCost;
                suggestedActivities.push({ name: 'هزینه حمل و نقل عمومی (ماهیانه)', count: `${numberOfPeople} نفر`, costUSD: publicTransportCost, category: 'هزینه‌های ثابت' });
            }


            const remainingIncomeUSD = monthlyIncomeUSD - totalFixedCostsUSD;
            let incomeLevel = '';
            if (remainingIncomeUSD < 0) incomeLevel = 'بسیار محدود';
            else if (remainingIncomeUSD < 50) incomeLevel = 'محدود';
            else if (remainingIncomeUSD < 200) incomeLevel = 'اقتصادی';
            else if (remainingIncomeUSD < 500) incomeLevel = 'متعادل';
            else incomeLevel = 'رفاهی';

            const budgetSuggestionDiv = document.getElementById('budgetSuggestion');
            const budgetSuggestionTitle = budgetSuggestionDiv.querySelector('h3');
            const budgetSuggestionText = budgetSuggestionDiv.querySelector('p');
            const activityTableBody = document.querySelector('#activityTable tbody');
            const totalActivityCostSpan = document.getElementById('totalActivityCost');
            const balanceSummaryDiv = document.getElementById('balanceSummary');
            const balanceRecommendationDiv = document.getElementById('balanceRecommendation');
            
            activityTableBody.innerHTML = ''; // Clear previous activities
            balanceSummaryDiv.innerHTML = ''; // Clear previous balance
            balanceRecommendationDiv.innerHTML = ''; // Clear previous recommendations

            // Add fixed costs to the table first
            suggestedActivities.forEach(activity => {
                const row = activityTableBody.insertRow();
                const cell1 = row.insertCell(0);
                const cell2 = row.insertCell(1);
                const cell3 = row.insertCell(2);
                const costToman = activity.costUSD * dollarRate;
                cell1.innerText = activity.name;
                cell2.innerText = activity.count;
                cell3.innerText = costToman.toLocaleString('fa-IR', { minimumFractionDigits: 0, maximumFractionDigits: 0 }) + ' تومان';
            });
            
            let discretionaryActivities = []; // Activities that come from remaining budget

            // 2. Discretionary Income & Recommendations for Leisure/Pleasure
            let adviceHTML = '';
            let totalDiscretionaryCostsUSD = 0;

            // Simplified approach for adding discretionary items based on income level
            const addDiscretionaryActivity = (name, count, minCostKey, maxCostKey = minCostKey, isPerPerson = false) => {
                let cost = iranianServiceCostsUSD[minCostKey].min;
                if (iranianServiceCostsUSD[maxCostKey]) { // Check if max exists
                    cost = (irarianServiceCostsUSD[minCostKey].min + iranianServiceCostsUSD[maxCostKey].max) / 2;
                }
                if (isPerPerson) {
                    cost *= numberOfPeople;
                }
                discretionaryActivities.push({ name: name, count: count, costUSD: cost, category: 'تفریحی/اختیاری' });
                totalDiscretionaryCostsUSD += cost;
            };

            budgetSuggestionTitle.innerText = `تحلیل بودجه شما: پیشنهاد مدل ${incomeLevel}`;
            switch (incomeLevel) {
                case 'بسیار محدود':
                    adviceHTML = `با توجه به <span class="highlight">کسری بودجه</span>، مدیریت مالی شما نیاز به بازنگری جدی دارد. تمرکز اصلی بر کاهش هزینه‌های ضروری و یافتن راه‌هایی برای **افزایش درآمد** باشد.`;
                    addDiscretionaryActivity('تفریح سبک و رایگان (مثل پیاده‌روی)', '۴ بار', 'تفریح سبک و رایگان (مثل پیاده‌روی)');
                    break;
                case 'محدود':
                    adviceHTML = `بودجه شما <span class="highlight">محدود</span> است. اولویت با تامین نیازهای اساسی است. در صورت امکان، با برنامه‌ریزی دقیق می‌توانید از تفریحات کم‌هزینه بهره‌مند شوید.`;
                    addDiscretionaryActivity('تفریح سبک و رایگان (مثل پیاده‌روی)', '۲ بار', 'تفریح سبک و رایگان (مثل پیاده‌روی)');
                    addDiscretionaryActivity('یک فنجان قهوه/آبمیوه (فصلی)', '۱ بار', 'کافه (یک بار)', 'کافه (یک بار)', true);
                    break;
                case 'اقتصادی':
                    adviceHTML = `با توجه به <span class="highlight">درآمد و وضعیت زندگی شما</span>، پیشنهاد ما یک مدل **اقتصادی** برای مدیریت بودجه تفریح است. تمرکز بر انتخاب‌های هوشمندانه و لذت‌بردن از فعالیت‌های کم‌هزینه.`;
                    addDiscretionaryActivity('آبمیوه طبیعی/قهوه در کافه', '۲ بار', 'کافه (یک بار)', 'کافه (یک بار)', true);
                    addDiscretionaryActivity('یک وعده غذای فست فود', '۱ بار', 'فست فود (یک وعده)', 'فست فود (یک وعده)', true);
                    addDiscretionaryActivity('بلیط سینما یا استفاده از استخر', '۱ بار', 'سینما (یک بلیط)', 'یک بار استفاده از استخر');
                    addDiscretionaryActivity('خرید یک کتاب جدید (هر دو ماه)', '۰.۵ بار', 'خرید یک کتاب جدید');
                    break;

                case 'متعادل':
                    adviceHTML = `شما در وضعیت <span class="highlight">متعادلی</span> قرار دارید و می‌توانید هم از زندگی لذت ببرید و هم پس‌انداز کنید. تعادل بین خرج کردن و پس‌انداز کلید موفقیت شماست.`;
                    addDiscretionaryActivity('آبمیوه طبیعی/قهوه در کافه', '۴ بار', 'کافه (یک بار)', 'کافه (یک بار)', true);
                    addDiscretionaryActivity('بلیط سینما و یک نوشیدنی', '۱ بار', 'سینما (یک بلیط)');
                    addDiscretionaryActivity('یک وعده غذای رستورانی (اقتصادی)', '۱ بار', 'رستوران لوکس (نفری)', 'رستوران لوکس (نفری)', true); // Using economic range for this
                    addDiscretionaryActivity('شهریه باشگاه ورزشی (ماهیانه)', '۱ بار', 'باشگاه (ماهیانه)', 'باشگاه (ماهیانه)', true);
                    addDiscretionaryActivity('خرید یک کتاب جدید', '۱ بار', 'خرید یک کتاب جدید');
                    addDiscretionaryActivity('اشتراک ماهانه نرم‌افزار کاربردی', '۱ بار', 'اشتراک ماهانه نرم‌افزار کاربردی', 'اشتراک ماهانه نرم‌افزار کاربردی', true);
                    addDiscretionaryActivity('مسافرت داخلی (اقتصادی) - (تقسیم بر ۳ ماه)', '۱ روز', 'مسافرت داخلی (اقتصادی، روزانه)');
                    break;

                case 'رفاهی':
                    adviceHTML = `شما در وضعیت <span class="highlight">رفاهی مناسبی</span> قرار دارید. می‌توانید از امکانات بیشتری بهره‌مند شوید و در عین حال، به پس‌انداز و سرمایه‌گذاری‌های بزرگ‌تر فکر کنید.`;
                    addDiscretionaryActivity('آبمیوه طبیعی/قهوه در کافه', '۶ بار', 'کافه (یک بار)', 'کافه (یک بار)', true);
                    addDiscretionaryActivity('بلیط سینما و یک نوشیدنی', '۲ بار', 'سینما (یک بلیط)');
                    addDiscretionaryActivity('یک وعده غذای رستورانی (لوکس)', '۱ بار', 'رستوران لوکس (نفری)', 'رستوران لوکس (نفری)', true);
                    addDiscretionaryActivity('شهریه باشگاه ورزشی (ماهیانه) / استخر', '۱ بار', 'باشگاه (ماهیانه)', 'یک بار استفاده از استخر');
                    addDiscretionaryActivity('کلاس آموزشی/تفریحی (ماهانه)', '۱ بار', 'کلاس آموزشی آنلاین/ورزش‌های انفرادی (ماهانه)', 'کلاس آموزشی آنلاین/ورزش‌های انفرادی (ماهانه)', true);
                    addDiscretionaryActivity('خرید کتاب/اشتراک نرم‌افزار', '۱ بار', 'خرید یک کتاب جدید', 'اشتراک ماهانه نرم‌افزار کاربردی');
                    addDiscretionaryActivity('مسافرت داخلی (متوسط/رفاهی) - (تقسیم بر ماه)', '۲ روز', 'مسافرت داخلی (متوسط، روزانه)', 'مسافرت داخلی (رفاهی، روزانه)');
                    
                    // Add items for specific inputs based on user profile, e.g., if "Other" for gender/marital status, or if age implies certain activities.
                    if (userAge < 30) {
                        addDiscretionaryActivity('استفاده از تاکسی برای تردد (چند سفر)', '۲-۳ بار', 'کرایه تاکسی (یک سفر)', 'کرایه تاکسی (یک سفر)', true);
                    }
                    if (userOccupation === 'دانشجو' || userOccupation === 'آزادکار/فریلنسر' || userOccupation === 'هنرمند') {
                        addDiscretionaryActivity('فعالیت‌های فرهنگی و هنری', '۱ بار', 'خرید یک کتاب جدید'); // Using book cost as a proxy
                    }
                    // Consider alcohol/cigarette if specified or user profile suggests
                    // if (Math.random() > 0.7) { 
                    //     addDiscretionaryActivity('سیگار (چند پاکت ماهیانه)', '۱۰ پاکت', 'سیگار (یک پاکت)');
                    // }
                    // if (Math.random() > 0.85 && userAge > 25) { 
                    //     addDiscretionaryActivity('مشروب (یک بطری)', '۰.۵ بطری', 'مشروب (یک بطری)');
                    // }
                    break;
            }

            budgetSuggestionText.innerHTML = adviceHTML;
            
            // Populate the discretionary activity table
            discretionaryActivities.forEach(activity => {
                const row = activityTableBody.insertRow();
                const cell1 = row.insertCell(0);
                const cell2 = row.insertCell(1);
                const cell3 = row.insertCell(2);

                const costToman = activity.costUSD * dollarRate;
                cell1.innerText = activity.name;
                cell2.innerText = activity.count;
                cell3.innerText = costToman.toLocaleString('fa-IR', { minimumFractionDigits: 0, maximumFractionDigits: 0 }) + ' تومان';
            });


            const totalProjectedExpensesUSD = totalFixedCostsUSD + totalDiscretionaryCostsUSD;
            const finalBalanceUSD = monthlyIncomeUSD - totalProjectedExpensesUSD;
            const finalBalanceToman = finalBalanceUSD * dollarRate;

            totalActivityCostSpan.innerText = (totalDiscretionaryCostsUSD * dollarRate).toLocaleString('fa-IR', { minimumFractionDigits: 0, maximumFractionDigits: 0 }) + ' تومان';

            let balanceSummaryHtml = '';
            if (finalBalanceToman >= 0) {
                balanceSummaryHtml = `<span class="positive-balance">مازاد بودجه ماهیانه شما: ${finalBalanceToman.toLocaleString('fa-IR', { minimumFractionDigits: 0, maximumFractionDigits: 0 })} تومان</span>`;
            } else {
                balanceSummaryHtml = `<span class="negative-balance">کسری بودجه ماهیانه شما: ${Math.abs(finalBalanceToman).toLocaleString('fa-IR', { minimumFractionDigits: 0, maximumFractionDigits: 0 })} تومان</span>`;
            }
            balanceSummaryDiv.innerHTML = balanceSummaryHtml;

            // Recommendations based on balance
            let recommendationHtml = '';
            if (finalBalanceUSD > 50) { // Significant surplus
                recommendationHtml = `<h4>پیشنهادات برای مازاد بودجه:</h4>
                    <ul>
                        <li><span class="highlight">پس‌انداز هدفمند:</span> بخشی از مازاد را برای اهداف بزرگتر (خرید خانه، خودرو، ازدواج، تحصیل فرزندان) پس‌انداز کنید.</li>
                        <li><span class="highlight">سرمایه‌گذاری:</span> با مشورت متخصص، مازاد بودجه را در بازار سهام، صندوق‌های سرمایه‌گذاری یا طلا سرمایه‌گذاری کنید.</li>
                        <li><span class="highlight">آموزش و توسعه فردی:</span> برای دوره‌های آموزشی، یادگیری مهارت جدید یا سفر مطالعاتی هزینه کنید.</li>
                        <li><span class="highlight">افزایش رفاه:</span> می‌توانید با برنامه‌ریزی، هزینه‌های تفریحی یا رفاهی خود را در ماه افزایش دهید.</li>
                    </ul>`;
            } else if (finalBalanceUSD >= 0 && finalBalanceUSD <= 50) { // Small surplus or balanced
                recommendationHtml = `<h4>پیشنهادات برای تعادل بودجه:</h4>
                    <ul>
                        <li><span class="highlight">پس‌انداز اضطراری:</span> حتی مقادیر کم را برای ایجاد یک صندوق اضطراری کنار بگذارید.</li>
                        <li><span class="highlight">برنامه‌ریزی دقیق‌تر:</span> برای خریدهای غیرضروری، لیست تهیه کنید و از خریدهای impulsivity بپرهیزید.</li>
                        <li><span class="highlight">سلامت و ورزش:</span> بخشی از بودجه را به فعالیت‌های ورزشی و تغذیه سالم اختصاص دهید.</li>
                    </ul>`;
            } else if (finalBalanceUSD < 0 && finalBalanceUSD > -100) { // Moderate deficit
                recommendationHtml = `<h4>راهکارهایی برای جبران کسری بودجه:</h4>
                    <ul>
                        <li><span class="highlight">بررسی هزینه‌ها:</span> ریزبینانه تمام خرج‌های ماهانه را بررسی و موارد غیرضروری را حذف کنید.</li>
                        <li><span class="highlight">کاهش تفریحات پرهزینه:</span> تفریحات ارزان‌تر یا رایگان را جایگزین کنید (مثلاً پارک، دورهمی خانگی).</li>
                        <li><span class="highlight">افزایش درآمد:</span> به دنبال فرصت‌های کسب درآمد جانبی، کار پاره‌وقت یا توسعه مهارت‌های شغلی باشید.</li>
                        <li><span class="highlight">مدیریت بدهی:</span> در صورت داشتن وام یا بدهی، برای بازپرداخت آن برنامه‌ریزی کنید.</li>
                    </ul>`;
            } else { // Large deficit
                recommendationHtml = `<h4>راهکارهای فوری برای مدیریت کسری بودجه شدید:</h4>
                    <ul>
                        <li><span class="highlight">کاهش شدید هزینه‌ها:</span> فقط روی نیازهای اساسی متمرکز شوید و تمام خرج‌های غیرضروری را قطع کنید.</li>
                        <li><span class="highlight">درآمدزایی اضطراری:</span> هر نوع کار پاره‌وقت یا موقت که می‌تواند درآمد ایجاد کند را دنبال کنید.</li>
                        <li><span class="highlight">مشاوره مالی:</span> در صورت لزوم، از یک مشاور مالی برای برنامه‌ریزی دقیق کمک بگیP>
                        <li><span class="highlight">بازنگری در سبک زندگی:</span> تغییرات اساسی در هزینه‌های ثابت (مانند مسکن یا حمل و نقل) را بررسی کنید.</li>
                    </ul>`;
            }
            balanceRecommendationDiv.innerHTML = recommendationHtml;


            document.getElementById('hypotheticalServicesResultDiv').style.display = 'block';
        }

        // --- Salawat Counter Logic ---
        let salawatCount = 0;
        let lastClickTime = 0;
        const MIN_CLICK_INTERVAL = 2000; // 2 seconds

        const encouragementMessages = [
            'ماشاالله!', 'آفرین!', 'ایول!', 'دمت گرم!', 'بابا بچه‌مذهبی ترکوندی!', 'همینطوری ادامه بده!', 'آااا ماشاالله!',
            'قبول باشه!', 'خدا قوت!', 'چه همت بلندی!', 'پر خیر و برکت!', 'موفق باشی!', 'فوق‌العاده‌ای!', 'احسنت!',
            'بهشت گوارای وجودت!', 'صلواتت مقبول حق!', 'روح‌پرور!', 'عالیه ادامه بده!', 'خدا همراهت!', 'پیروز باشی!'
        ];

        function showEncouragement() {
            const messageDiv = document.getElementById('encouragementMessage');
            const randomMessage = encouragementMessages[Math.floor(Math.random() * encouragementMessages.length)];
            messageDiv.innerText = randomMessage;
            messageDiv.style.opacity = 1;
            setTimeout(() => {
                messageDiv.style.opacity = 0;
            }, 1500); // Message fades out after 1.5 seconds
        }

        function incrementSalawat() {
            const currentTime = new Date().getTime();
            if (currentTime - lastClickTime < MIN_CLICK_INTERVAL) {
                // Optionally provide feedback if clicked too fast
                // console.log("Please wait 2 seconds between salawats.");
                return;
            }
            lastClickTime = currentTime;

            salawatCount++;
            document.getElementById('salawatCount').innerText = salawatCount;
            showEncouragement();

            const targetInput = document.getElementById('salawatTargetInput');
            const target = parseInt(targetInput.value);

            if (!isNaN(target) && target > 0 && salawatCount >= target) {
                document.getElementById('targetReachedMessage').style.display = 'block';
                document.getElementById('salawatButton').disabled = true; // Disable button when target reached
            }
        }

        // Initial setup: On page load, no section is active by default.
        document.addEventListener('DOMContentLoaded', () => {
            // Optional: You can uncomment the line below to show a default section on load
            // showSection('goldCalculator', document.querySelector('.nav-button[data-color="gold"]'));
        });
    </script>
</body>
</html>
