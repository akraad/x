<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پرسشنامه شناخت جنسی</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f6;
            color: #333;
            direction: rtl; /* Right-to-left for Persian */
            text-align: right;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            background-color: #ffffff;
            padding: 30px 40px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        h1, h2 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 25px;
        }
        .section {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        .section:last-child {
            border-bottom: none;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }
        input[type="text"],
        input[type="number"],
        select {
            width: calc(100% - 22px);
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 1rem;
            box-sizing: border-box;
            background-color: #fcfcfc;
        }
        input[type="radio"] {
            margin-left: 10px;
            margin-right: 5px;
            transform: scale(1.2); /* Slightly larger radio buttons */
        }
        .radio-option {
            display: block;
            margin-bottom: 10px;
            padding: 8px 0;
            cursor: pointer;
        }
        .radio-option:hover {
            background-color: #f9f9f9;
        }
        .btn {
            display: block;
            width: 100%;
            padding: 15px 25px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 30px;
        }
        .btn:hover {
            background-color: #218838;
        }
        .disclaimer {
            background-color: #ffeeba;
            border: 1px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
            color: #856404;
            text-align: center;
            font-size: 0.95rem;
        }
        .hidden {
            display: none;
        }
        .question-block {
            margin-bottom: 25px;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #fdfdfd;
        }
        .question-block p {
            font-weight: bold;
            margin-top: 0;
            margin-bottom: 15px;
            color: #333;
            font-size: 1.1rem;
        }
        .analysis-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #eee;
        }
        .chart-container {
            margin-top: 20px;
            direction: ltr; /* Charts are usually LTR */
            text-align: left;
            overflow-x: auto; /* For small screens */
        }
        .chart-bar-wrapper {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .chart-label {
            width: 150px;
            font-size: 0.9em;
            color: #555;
            text-align: right;
            padding-right: 10px;
        }
        .chart-bar {
            height: 25px;
            background-color: #4CAF50; /* Green */
            border-radius: 3px;
            position: relative;
            margin-right: 5px; /* Space between bar and percentage */
        }
        .chart-percentage {
            font-size: 0.9em;
            font-weight: bold;
            color: #333;
            min-width: 40px; /* Ensure space for percentage */
            text-align: left;
        }

        /* Responsive adjustments */
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            .btn {
                font-size: 1rem;
            }
            .chart-label {
                width: 100px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>پرسشنامه شناخت جنسی</h1>
        <p class="disclaimer">
            <i class="fa fa-lock"></i> تمامی پاسخ‌های شما کاملاً محرمانه باقی خواهند ماند و صرفاً برای ارائه مشاوره بهتر مورد استفاده قرار می‌گیرند. اطلاعات شما با هیچ شخص یا نهادی به اشتراک گذاشته نخواهد شد.
        </p>

        <form id="sexualHealthSurvey">
            <div id="initialInfoSection" class="section">
                <h2>اطلاعات اولیه</h2>
                <div class="form-group">
                    <label for="age">سن:</label>
                    <input type="number" id="age" name="age" min="18" max="99" required>
                </div>
                <div class="form-group">
                    <label for="maritalStatus">وضعیت تأهل:</label>
                    <select id="maritalStatus" name="maritalStatus" required>
                        <option value="">انتخاب کنید</option>
                        <option value="مجرد">مجرد</option>
                        <option value="متأهل">متأهل</option>
                        <option value="مطلقه">مطلقه</option>
                        <option value="بیوه">بیوه</option>
                        <option value="در_رابطه_بدون_ازدواج">در رابطه بدون ازدواج</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="gender">جنسیت:</label>
                    <select id="gender" name="gender" required>
                        <option value="">انتخاب کنید</option>
                        <option value="زن">زن</option>
                        <option value="مرد">مرد</option>
                        <option value="غیره">غیره</option>
                        <option value="ترجیح_میدهم_نگویم">ترجیح می‌دهم نگویم</option>
                    </select>
                </div>
                <button type="button" class="btn" onclick="startSurvey()">شروع پرسشنامه</button>
            </div>

            <div id="questionsSection" class="section hidden">
                <h2>سوالات پرسشنامه</h2>
                <div id="questionsContainer"></div>
                <button type="submit" class="btn">تکمیل و دریافت تحلیل</button>
            </div>
        </form>

        <div id="analysisSection" class="section hidden analysis-section">
            <h2>تحلیل اولیه نتایج شما</h2>
            <div id="analysisContent">
                <p>با تشکر از شما برای شرکت در این پرسشنامه. در ادامه خلاصه‌ای از پاسخ‌های شما بر اساس دسته‌بندی‌های کلی ارائه می‌شود.</p>

                <h3>گرایش‌های کلی</h3>
                <div class="chart-container">
                    <div class="chart-bar-wrapper">
                        <span class="chart-label">رضایت از رابطه:</span>
                        <div id="satisfactionBar" class="chart-bar"></div>
                        <span id="satisfactionPercentage" class="chart-percentage"></span>
                    </div>
                    <div class="chart-bar-wrapper">
                        <span class="chart-label">میزان خودشناسی جنسی:</span>
                        <div id="selfKnowledgeBar" class="chart-bar"></div>
                        <span id="selfKnowledgePercentage" class="chart-percentage"></span>
                    </div>
                    <div class="chart-bar-wrapper">
                        <span class="chart-label">تمایل به فانتزی و تنوع:</span>
                        <div id="fantasyBar" class="chart-bar"></div>
                        <span id="fantasyPercentage" class="chart-percentage"></span>
                    </div>
                    <div class="chart-bar-wrapper">
                        <span class="chart-label">اهمیت عاطفه در سکس:</span>
                        <div id="emotionBar" class="chart-bar"></div>
                        <span id="emotionPercentage" class="chart-percentage"></span>
                    </div>
                </div>
                <p id="orientationSummary"></p>
                <p id="fantasySummary"></p>
                <p id="communicationSummary"></p>
                <p id="generalSummary"></p>
                <br>
                <p>این تحلیل یک دید کلی از تمایلات و نیازهای شما ارائه می‌دهد. برای مشاوره دقیق‌تر و شخصی‌سازی شده، پیشنهاد می‌شود با یک مشاور متخصص صحبت کنید.</p>
            </div>
        </div>
    </div>

    <script>
        const allQuestions = [
            { id: 1, text: "تا حالا چند بار به شریک جنسیت دروغ گفتی که ارضا شدی؟", options: ["هرگز، همیشه صادق بودم", "یکی دو بار پیش اومده", "زیاد، چون نمی‌خواستم دلخور بشه", "تقریبا همیشه", "شریک ثابتی نداشتم", "کلاً هیچ وقت ارضا نشدم که راست یا دروغ بگم!"] },
            { id: 2, text: "کدوم یکی از این فانتزی‌ها بیشتر برات تحریک‌کننده‌ست؟", options: ["رابطه در مکان‌های عمومی", "بازی نقش (مثل استاد/دانشجو یا رئیس/منشی)", "تسلط یا تسلیم (BDSM ملایم)", "چندنفره یا تماشای شریک با دیگری", "فتیش خاص (پا، لباس، بوی بدن و...)", "هیچکدوم از اینا برام جذاب نیست"] },
            { id: 3, text: "معمولا چند بار در هفته خودارضایی می‌کنی؟", options: ["هر روز چند بار", "روزی یک‌بار", "۲–۳ بار در هفته", "یکی دو بار در ماه", "به ندرت", "هیچ‌وقت، اصلاً علاقه ندارم"] },
            { id: 4, text: "با کدوم جمله بیشتر هم‌ذات‌پنداری می‌کنی؟", options: ["سکس فقط با احساس عشقه", "سکس می‌تونه بی‌عشق هم جذاب باشه", "رابطه طولانی بهتر از تنوعه", "تنوع برام مهم‌تر از پایداریه", "تجربه مهم‌تر از تعهده", "هنوز خودم هم نمی‌دونم چی می‌خوام"] },
            { id: 5, text: "گرایش جنسی‌ت رو چطور تعریف می‌کنی؟", options: ["فقط دگرجنس‌گرا (زن/مرد مخالف خودم)", "بیشتر دگرجنس‌گرا، ولی کمی کنجکاوم", "دوجنس‌گرا", "هم‌جنس‌گرا", "پان‌سکشوال / بی‌تمایز", "مطمئن نیستم / نمی‌خوام برچسب بزنم"] },
            { id: 6, text: "چقدر در رابطه‌هات احساس امنیت برای بیان نیازهای جنسی‌ت داری؟", options: ["کامل، بدون ترس می‌گم", "معمولاً راحت می‌گم", "بستگی داره به طرف مقابلم", "بیشتر وقت‌ها خجالت می‌کشم", "اصلاً نمی‌تونم بگم", "تا حالا رابطه جدی نداشتم"] },
            { id: 7, text: "وقتی به سکس فکر می‌کنی، بیشتر چه چیزی برات اولویت داره؟", options: ["لذت بدنی", "لذت روحی و عاطفی", "ارضای طرف مقابل", "تجربه‌های تازه", "قدرت‌نمایی یا تسلیم شدن", "فرار از استرس و واقعیت"] },
            { id: 8, text: "کدوم جمله بیشتر توصیف‌کننده حالت بعد از خودارضاییه؟", options: ["احساس آرامش می‌کنم", "احساس گناه دارم", "هیچ احساسی ندارم", "اغلب پشیمون می‌شم", "حس لذت، اما نه مثل سکس واقعی", "من خودارضایی نمی‌کنم"] },
            { id: 9, text: "تا حالا تجربه رابطه با جنس موافق داشتی؟", options: ["بله، و لذت‌بخش بود", "بله، ولی جذاب نبود", "فقط برای کنجکاوی", "فکرشو کردم ولی انجام ندادم", "اصلاً علاقه ندارم", "هنوز نمی‌دونم چه گرایشی دارم"] },
            { id: 10, text: "بیشتر تحریک جنسی‌ت از کدوم منبعه؟", options: ["تصاویر/ویدئو", "تخیلات شخصی", "لمس و تماس بدنی", "صحبت و صدا", "بوی بدن یا لباس", "چیزای غیرمعمول و خاص (فتیش)"] },
            { id: 11, text: "دوست داری تو رابطه جنسی کنترل دست تو باشه یا طرف مقابل؟", options: ["همیشه من کنترل‌کننده باشم", "ترجیح می‌دم من هدایت کنم", "مساوی باشه", "کمی سلطه‌پذیرم", "دوست دارم تسلیم مطلق باشم", "بستگی به حال و موقعیت داره"] },
            { id: 12, text: "تو رابطه جنسی، برات مهم‌تره که...؟", options: ["زود به اوج برسم", "طرف مقابلم زودتر ارضا شه", "هر دو همزمان ارضا بشیم", "بیشتر پیش‌نوازی کنیم", "طولانی باشه، حتی اگه دیر تموم بشه", "کیفیت مهم‌تر از کمیت باشه"] },
            { id: 13, text: "در مورد BDSM (بازی‌های سلطه و قدرت) چه نظری داری؟", options: ["علاقه زیادی دارم", "کمی امتحان کردم و خوشم اومد", "تجربه نکردم ولی کنجکاوم", "بهش فکر می‌کنم ولی می‌ترسم", "اصلاً نمی‌پسندم", "نمی‌دونم چی هست دقیقاً"] },
            { id: 14, text: "چه چیزی باعث کاهش میل جنسیت می‌شه؟", options: ["استرس یا فشار روانی", "بی‌اعتمادی به شریک", "تکراری شدن رابطه", "مسائل جسمی/هورمونی", "مشکلات احساسی", "هیچ‌چیز، همیشه آماده‌ام!"] },
            { id: 15, text: "چقدر از بدن خودت در رابطه جنسی احساس رضایت داری؟", options: ["کاملاً راحت و راضی‌ام", "بیشتر اوقات راضیم", "معمولی‌ام، نه خیلی خوب نه بد", "گاهی خجالت می‌کشم", "احساس ناامنی زیادی دارم", "اصلاً از بدنم خوشم نمیاد"] },
            { id: 16, text: "آیا فانتزی‌هایی داری که از گفتنشون خجالت بکشی؟", options: ["نه، همه چیزو می‌گم", "یکی دو مورد هست", "فانتزی‌هام خیلی خاصن و نمی‌گم", "خیلی خجالت می‌کشم", "هنوز فانتزی مشخصی ندارم", "فانتزی‌هامو حتی با خودم هم در میون نمی‌ذارم!"] },
            { id: 17, text: "تا حالا شده از رابطه جنسی فقط برای به‌دست آوردن چیزی استفاده کنی؟", options: ["بله، چند بار", "یه‌بار", "وسوسه داشتم ولی نکردم", "نه، اصلاً چنین قصدی نداشتم", "حس می‌کنم دیگران ازم سوءاستفاده کردن", "نمی‌خوام جواب بدم"] },
            { id: 18, text: "در مورد رابطه جنسی دهانی چه نظری داری؟", options: ["علاقه زیادی دارم به دادن و گرفتن", "فقط دریافت‌کننده‌ام", "فقط در صورت عشق عمیق انجامش می‌دم", "برام معمولیه", "خوشم نمیاد", "تا حالا تجربه‌اش نکردم"] },
            { id: 19, text: "در حالت عادی، در طول رابطه جنسی چند بار می‌تونی ارضا بشی؟", options: ["یک‌بار کافیه", "معمولاً دوبار", "۳ بار یا بیشتر", "بستگی به موقعیت داره", "بعضی وقتا اصلاً ارضا نمی‌شم", "نمی‌دونم، تجربه کافی ندارم"] },
            { id: 20, text: "کدوم یکی از اینا تحریک بیشتری برات داره؟", options: ["لباس زیر خاص", "بوی بدن/بوی مو", "صدای نفس کشیدن یا ناله", "نگاه کردن", "حرف‌های کثیف یا شهوانی", "همه‌ی موارد بالا"] },
            { id: 21, text: "وقتی به رابطه جنسی فکر می‌کنی، تصویر غالب ذهنی‌ات چیه؟", options: ["بدن طرف مقابل", "نوع لمس و تماس", "صداها و ناله‌ها", "حالت‌های سلطه یا تسلیم", "فانتزی‌های غیرمعمول", "هیچی خاص نیست، فقط حس کلیه"] },
            { id: 22, text: "ترجیح می‌دی سکس چقدر طول بکشه؟", options: ["زیر ۵ دقیقه، سریع و پرشور", "۱۰ تا ۱۵ دقیقه", "حدود نیم ساعت", "هرچی بیشتر بهتر", "بستگی به حال من و طرف داره", "مهم نیست، کیفیت برام مهم‌تره"] },
            { id: 23, text: "در مورد لوازم جنسی (Sex Toys) چه نظری داری؟", options: ["استفاده می‌کنم و خیلی راضیم", "گاهی استفاده کردم", "دوست دارم امتحان کنم", "کنجکاوم ولی می‌ترسم", "اصلاً علاقه ندارم", "نمی‌دونم از کجا شروع کنم"] },
            { id: 24, text: "بیشتر رابطه‌های جنسیت با چه کیفیتی بودن؟", options: ["عالی و رضایت‌بخش", "خوب، ولی می‌تونست بهتر باشه", "متوسط", "ضعیف و پر از نارضایتی", "بیشتر برای خوشحال کردن طرف مقابل بوده", "اصلاً تجربه ندارم"] },
            { id: 25, text: "تا حالا شده در حین رابطه جنسی به کس دیگه‌ای فکر کنی؟", options: ["نه، هیچ‌وقت", "یکی دو بار", "گاهی اتفاق می‌افته", "اغلب اوقات", "تقریباً همیشه", "چون معمولاً تخیلی ارضا می‌شم، بله"] },
            { id: 26, text: "چقدر با بدن شریک جنسی‌ت احساس کشش و لذت داری؟", options: ["زیاد، خیلی جذبشم", "جذبش هستم ولی جا برای بهتر شدن هست", "متوسط", "کششی حس نمی‌کنم", "فقط برای رابطه هستم، نه جذابیت", "هنوز رابطه‌ای نداشتم"] },
            { id: 27, text: "آیا در رابطه، تظاهر به لذت کرده‌ای؟", options: ["هرگز", "یکی دو بار", "گاهی", "خیلی زیاد", "همیشه، چون طرفم بلد نیست", "هنوز تجربه رابطه ندارم"] },
            { id: 28, text: "چقدر از حرف زدن حین سکس خوشت میاد؟", options: ["خیلی، تحریک‌کننده‌ست", "معمولاً خوبه", "اگه طبیعی باشه، خوبه", "دوست ندارم کسی چیزی بگه", "خودم خجالت می‌کشم حرف بزنم", "اصلاً نمی‌دونم چی باید بگم!"] },
            { id: 29, text: "آیا فانتزی خشونت ملایم در سکس داری؟ (مثل کشیدن مو، گاز گرفتن، اسلیپ زدن)", options: ["بله، خیلی تحریک‌کننده‌ست", "کمی علاقه دارم", "تجربه کردم و خوشم نیومد", "هنوز امتحان نکردم", "نمی‌پسندم", "فکرشم آزارم می‌ده"] },
            { id: 30, text: "در مورد پوزیشن‌های جنسی مختلف چقدر تجربه داری؟", options: ["خیلی زیاد", "چند مدل محدود", "یکی دو مدل ثابت", "فقط همون پوزیشن کلاسیک", "تجربه ندارم ولی کنجکاوم", "تا حالا تجربه نداشتم"] },
            { id: 31, text: "وقتی خودارضایی می‌کنی، بیشتر چه فکری در ذهنت هست؟", options: ["کسی که می‌شناسم", "یک سلبریتی", "صحنه خاص یا فانتزی ذهنی", "موقعیتی سلطه‌آمیز یا تسلیم", "فقط تخلیه بدنی، بدون فکر خاص", "اصلاً خودارضایی نمی‌کنم"] },
            { id: 32, text: "بیشتر اوقات سکس برات از کجا شروع می‌شه؟", options: ["با صحبت یا شوخی جنسی", "از لمس و نوازش", "با نگاه و فاصله نزدیک", "یه‌دفعه‌ای و بدون مقدمه", "با درددل و ارتباط عاطفی", "معمولاً از من شروع نمی‌شه!"] },
            { id: 33, text: "آیا در کودکی یا نوجوانی تجربه جنسی ناخواسته داشتی؟", options: ["بله، و هنوز تأثیرش هست", "بله، ولی باهاش کنار اومدم", "نه، هیچ‌وقت", "نمی‌دونم چی حساب می‌شه", "ترجیح می‌دم جواب ندم", "خاطره‌ای مبهم دارم ولی مطمئن نیستم"] },
            { id: 34, text: "اگر طرفت بخواد فانتزی غیرعادی‌ای رو امتحان کنه، چی‌کار می‌کنی؟", options: ["مشتاقانه امتحان می‌کنم", "باهاش صحبت می‌کنم", "یک‌بار امتحان، ببینم چطوره", "با اکراه قبول می‌کنم", "رد می‌کنم", "خودم فانتزی‌های عجیب‌تر دارم!"] },
            { id: 35, text: "بیشترین لذت جنسی رو کی تجربه کردی؟", options: ["با شریک فعلی", "با شریک قبلی", "توی خودارضایی", "توی تخیلاتم", "هنوز تجربه خوبی نداشتم", "اصلاً نمی‌تونم لذت رو تعریف کنم"] },
            { id: 36, text: "به نظرت رابطه جنسی خوب باید چند وقت یک‌بار باشه؟", options: ["روزانه", "۳–۴ بار در هفته", "هفته‌ای یک‌بار", "بسته به میل دو طرف", "هر وقت حسش باشه", "فعلاً نیازی نمی‌بینم"] },
            { id: 37, text: "چقدر حاضری نیازهای جنسی طرف مقابلت رو در اولویت بذاری؟", options: ["همیشه اول اون", "معمولاً توجه دارم", "نیمی‌نیم", "بیشتر به خودم فکر می‌کنم", "اگه من حال نداشته باشم، هیچ", "بستگی به اخلاقش داره"] },
            { id: 38, text: "از چه چیزی در سکس می‌ترسی؟", options: ["قضاوت شدن", "عملکرد ضعیف", "درد", "دوست نداشتن بدنم", "وابسته شدن", "هیچ‌چیز، کاملاً راحتم"] },
            { id: 39, text: "اگه رابطه جنسی بدون عشق باشه...؟", options: ["اصلاً واردش نمی‌شم", "اگه حس باشه، خوبه", "سکس و عشق دو چیز جدا هستن", "تجربه می‌کنم ولی وابسته نمی‌شم", "ترجیح می‌دم فقط عشق باشه", "عشق اصلاً مهم نیست"] },
            { id: 40, text: "تا حالا فانتزی 'تماشا شدن' یا 'تماشا کردن' حین رابطه داشتی؟", options: ["بله، خیلی تحریکم می‌کنه", "کنجکاوم ولی امتحان نکردم", "تو پورن دیدم ولی نمی‌خوام امتحان کنم", "اصلاً خوشم نمیاد", "دوست دارم امتحان کنم", "نمی‌فهمم چرا کسی بخواد اینو!"] },
            { id: 41, text: "چقدر در مورد بهداشت جنسی اطلاعات داری؟", options: ["زیاد، مطالعه کردم", "متوسط", "در حد تجربه شخصی", "اطلاعاتم خیلی کمه", "فقط وقتی لازم باشه چیزی می‌خونم", "تقریباً هیچی نمی‌دونم"] },
            { id: 42, text: "در مورد استفاده از کاندوم چه نظری داری؟", options: ["همیشه استفاده می‌کنم", "فقط با افراد ناشناس", "بستگی به شرایط", "نمی‌پسندم ولی گاهی اجباره", "اصلاً استفاده نمی‌کنم", "تجربه رابطه واقعی نداشتم"] },
            { id: 43, text: "چه چیزی برات 'سکس ایده‌آل' رو می‌سازه؟", options: ["توجه و درک دو طرف", "فانتزی و تنوع", "شور و هیجان بدنی", "عاطفه و احساس", "نقش بازی کردن", "بدون محدودیت و مرز"] },
            { id: 44, text: "تا حالا از پورن برای یاد گرفتن سکس استفاده کردی؟", options: ["بله، منبع اصلی‌م بوده", "گاهی کمک کرده", "نگاه می‌کنم ولی برای یادگیری نه", "نه، بیشتر گمراهم کرد", "اصلاً نمی‌بینم", "پورن واقعی نیست، تجربه مهمه"] },
            { id: 45, text: "آیا برای برقراری رابطه جنسی به الکل یا مواد متوسل شدی؟", options: ["بله، اغلب", "گاهی", "یکی دو بار", "فقط برای رهایی از خجالت", "نه، اصلاً", "اهل این چیزا نیستم"] },
            { id: 46, text: "چقدر با خودت در مورد مرزهای جنسی‌ت شفاف هستی؟", options: ["کاملاً مشخصه چی می‌خوام و چی نمی‌خوام", "تقریباً می‌دونم", "هنوز دارم کشف می‌کنم", "مرز خاصی ندارم", "با هر کسی فرق داره", "اصلاً فکر نکردم تا حالا"] },
            { id: 47, text: "رابطه جنسی ایده‌آل باید چقدر عاطفه داشته باشه؟", options: ["زیاد، بیشتر از سکس", "ترکیب متعادل", "بسته به رابطه‌ست", "فقط لذت بدنی مهمه", "هیچ ربطی به عشق نداره", "بستگی به حال و روزمه"] },
            { id: 48, text: "تا حالا با کسی فقط برای سکس وارد رابطه شدی؟", options: ["بله، بارها", "یکی دو بار", "وسوسه داشتم", "نه، هیچ‌وقت", "فکر می‌کردم عشق باشه ولی نبود", "نمی‌خوام جواب بدم"] },
            { id: 49, text: "در مورد نقش جنسی (اکتیو، پسیو، سوئیچ) چطور فکر می‌کنی؟", options: ["فقط اکتیو (فعال)", "بیشتر اکتیو، ولی گاهی تغییر می‌دم", "سوئیچ هستم (هر دو نقش)", "بیشتر پسیو", "فقط پسیو", "تجربه کافی ندارم برای نظر دادن"] },
            { id: 50, text: "چه نوع مشاوره‌ای الان بیشتر از همه بهش نیاز داری؟", options: ["شناخت بهتر خودم و تمایلاتم", "تقویت رابطه با شریکم", "درمان اختلال یا نارضایتی جنسی", "خروج از تکرار و یکنواختی", "مدیریت فانتزی‌ها یا گرایش‌های خاص", "نمی‌دونم از کجا شروع کنم"] }
        ];

        let selectedQuestions = [];

        function startSurvey() {
            const age = document.getElementById('age').value;
            const maritalStatus = document.getElementById('maritalStatus').value;
            const gender = document.getElementById('gender').value;

            if (!age || !maritalStatus || !gender) {
                alert('لطفاً تمامی اطلاعات اولیه را تکمیل کنید.');
                return;
            }

            document.getElementById('initialInfoSection').classList.add('hidden');
            document.getElementById('questionsSection').classList.remove('hidden');
            generateRandomQuestions();
        }

        function generateRandomQuestions() {
            const questionsContainer = document.getElementById('questionsContainer');
            questionsContainer.innerHTML = ''; // Clear previous questions

            // Shuffle allQuestions array
            const shuffledQuestions = [...allQuestions].sort(() => 0.5 - Math.random());

            // Select the first 10 questions
            selectedQuestions = shuffledQuestions.slice(0, 10);

            selectedQuestions.forEach((q, index) => {
                const questionBlock = document.createElement('div');
                questionBlock.classList.add('question-block');
                questionBlock.innerHTML = `<p>${index + 1}. ${q.text}</p>`;

                q.options.forEach((option, optionIndex) => {
                    const radioOption = document.createElement('label');
                    radioOption.classList.add('radio-option');
                    radioOption.innerHTML = `
                        <input type="radio" name="question${q.id}" value="${optionIndex}" required>
                        ${option}
                    `;
                    questionBlock.appendChild(radioOption);
                });
                questionsContainer.appendChild(questionBlock);
            });
        }

        document.getElementById('sexualHealthSurvey').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const answers = {};
            for (let [key, value] of formData.entries()) {
                if (key.startsWith('question')) {
                    const questionId = parseInt(key.replace('question', ''));
                    answers[questionId] = parseInt(value); // Store option index
                } else {
                    answers[key] = value;
                }
            }
            displayAnalysis(answers);
        });

        function displayAnalysis(answers) {
            document.getElementById('questionsSection').classList.add('hidden');
            document.getElementById('analysisSection').classList.remove('hidden');

            // --- Simplified Analysis Logic ---
            let satisfactionScore = 0; // Higher is better
            let selfKnowledgeScore = 0; // Higher is better
            let fantasyDiversityScore = 0; // Higher is more diverse/open
            let emotionInSexScore = 0; // Higher means more importance on emotion

            // Analyze answers based on pre-defined scoring for general categories
            selectedQuestions.forEach(q => {
                const answerIndex = answers[q.id];
                if (answerIndex === undefined) return; // Skip if question not answered

                switch (q.id) {
                    case 1: // ارضا شدن دروغ
                        if ([0].includes(answerIndex)) satisfactionScore += 10; // Never lied
                        if ([1].includes(answerIndex)) satisfactionScore += 5;
                        if ([2,3].includes(answerIndex)) satisfactionScore -= 5; // Often lied
                        if ([5].includes(answerIndex)) satisfactionScore = 0; // Never satisfied
                        break;
                    case 4: // سکس با عشق
                        if ([0].includes(answerIndex)) emotionInSexScore += 10;
                        if ([1].includes(answerIndex)) emotionInSexScore += 2;
                        if ([2].includes(answerIndex)) emotionInSexScore += 7;
                        if ([3,4].includes(answerIndex)) emotionInSexScore -= 5;
                        break;
                    case 5: // گرایش جنسی
                        if ([0].includes(answerIndex)) selfKnowledgeScore += 5; // Clear on hetero
                        if ([1,2,3,4].includes(answerIndex)) selfKnowledgeScore += 10; // Open/identified
                        if ([5].includes(answerIndex)) selfKnowledgeScore += 2; // Unsure
                        break;
                    case 6: // امنیت در بیان نیازها
                        if ([0,1].includes(answerIndex)) satisfactionScore += 10; // Comfortable
                        if ([2].includes(answerIndex)) satisfactionScore += 5;
                        if ([3,4].includes(answerIndex)) satisfactionScore -= 5; // Uncomfortable
                        break;
                    case 7: // اولویت در سکس
                        if ([1].includes(answerIndex)) emotionInSexScore += 10; // Emotional pleasure
                        if ([0].includes(answerIndex)) satisfactionScore += 5; // Physical pleasure
                        if ([3,4].includes(answerIndex)) fantasyDiversityScore += 5; // New experiences/power play
                        break;
                    case 9: // رابطه با جنس موافق
                        if ([0,1,2].includes(answerIndex)) selfKnowledgeScore += 7; // Experienced/curious
                        if ([3].includes(answerIndex)) selfKnowledgeScore += 3; // Considered
                        break;
                    case 10: // منبع تحریک
                        if ([0,1,2,3,4,5].includes(answerIndex)) fantasyDiversityScore += 3; // Indicates variety of sources
                        break;
                    case 13: // BDSM
                        if ([0,1,2].includes(answerIndex)) fantasyDiversityScore += 7; // Open to BDSM
                        if ([3].includes(answerIndex)) fantasyDiversityScore += 3; // Curious but scared
                        break;
                    case 15: // رضایت از بدن
                        if ([0,1].includes(answerIndex)) satisfactionScore += 10;
                        if ([2].includes(answerIndex)) satisfactionScore += 5;
                        if ([3,4,5].includes(answerIndex)) satisfactionScore -= 5;
                        break;
                    case 16: // فانتزی خجالت‌آور
                        if ([0].includes(answerIndex)) selfKnowledgeScore += 10; // Open/transparent
                        if ([1,2,3].includes(answerIndex)) selfKnowledgeScore += 5;
                        break;
                    case 24: // کیفیت رابطه جنسی
                        if ([0].includes(answerIndex)) satisfactionScore += 10;
                        if ([1].includes(answerIndex)) satisfactionScore += 7;
                        if ([2].includes(answerIndex)) satisfactionScore += 3;
                        if ([3,4].includes(answerIndex)) satisfactionScore -= 10;
                        break;
                    case 25: // فکر کردن به دیگری
                        if ([0].includes(answerIndex)) emotionInSexScore += 5; // Focus on partner
                        if ([2,3,4,5].includes(answerIndex)) emotionInSexScore -= 5; // Distraction/fantasy
                        break;
                    case 27: // تظاهر به لذت
                        if ([0].includes(answerIndex)) satisfactionScore += 10;
                        if ([1,2].includes(answerIndex)) satisfactionScore += 5;
                        if ([3,4].includes(answerIndex)) satisfactionScore -= 10;
                        break;
                    case 28: // حرف زدن حین سکس
                        if ([0,1,2].includes(answerIndex)) selfKnowledgeScore += 5; // Open to communication
                        if ([3,4].includes(answerIndex)) selfKnowledgeScore += 2; // Less open
                        break;
                    case 29: // فانتزی خشونت ملایم
                        if ([0,1].includes(answerIndex)) fantasyDiversityScore += 5;
                        break;
                    case 34: // فانتزی غیرعادی
                        if ([0,1,2].includes(answerIndex)) fantasyDiversityScore += 10; // Open to new things
                        if ([3].includes(answerIndex)) fantasyDiversityScore += 5;
                        break;
                    case 37: // اولویت نیاز شریک
                        if ([0,1].includes(answerIndex)) emotionInSexScore += 10;
                        if ([2].includes(answerIndex)) emotionInSexScore += 5;
                        if ([3,4].includes(answerIndex)) emotionInSexScore -= 5;
                        break;
                    case 39: // سکس بدون عشق
                        if ([0,4].includes(answerIndex)) emotionInSexScore += 10; // Needs love
                        if ([1,2,3].includes(answerIndex)) emotionInSexScore += 5; // Can separate
                        break;
                    case 43: // سکس ایده آل
                        if ([0,3].includes(answerIndex)) emotionInSexScore += 10;
                        if ([1,2,4,5].includes(answerIndex)) fantasyDiversityScore += 5;
                        break;
                    case 46: // مرزهای جنسی
                        if ([0].includes(answerIndex)) selfKnowledgeScore += 10;
                        if ([1].includes(answerIndex)) selfKnowledgeScore += 7;
                        if ([2].includes(answerIndex)) selfKnowledgeScore += 5;
                        break;
                    case 47: // عاطفه در سکس ایده آل
                        if ([0].includes(answerIndex)) emotionInSexScore += 10;
                        if ([1].includes(answerIndex)) emotionInSexScore += 7;
                        if ([2].includes(answerIndex)) emotionInSexScore += 5;
                        break;
                    case 49: // نقش جنسی
                        if ([0,1,2,3,4].includes(answerIndex)) selfKnowledgeScore += 7;
                        if ([5].includes(answerIndex)) selfKnowledgeScore += 2;
                        break;
                    case 50: // نیاز به مشاوره
                        if ([0].includes(answerIndex)) selfKnowledgeScore += 10;
                        if ([1].includes(answerIndex)) emotionInSexScore += 5;
                        if ([2].includes(answerIndex)) satisfactionScore -= 5;
                        break;
                }
            });

            // Normalize scores to a percentage out of 100 for display (example max score set to 30 for illustration)
            const maxPossibleScore = 100; // Adjust based on your scoring logic and question weights
            const normalize = (score) => Math.max(0, Math.min(100, Math.round((score / maxPossibleScore) * 100)));

            const finalSatisfaction = normalize(satisfactionScore);
            const finalSelfKnowledge = normalize(selfKnowledgeScore);
            const finalFantasyDiversity = normalize(fantasyDiversityScore);
            const finalEmotionInSex = normalize(emotionInSexScore);


            // Update the chart bars and percentages
            function updateChartBar(barId, percentageId, value) {
                const bar = document.getElementById(barId);
                const percentageSpan = document.getElementById(percentageId);
                bar.style.width = `${value}%`;
                bar.style.backgroundColor = value > 75 ? '#4CAF50' : (value > 40 ? '#FFC107' : '#F44336'); /* Green, Yellow, Red */
                percentageSpan.textContent = `${value}%`;
            }

            updateChartBar('satisfactionBar', 'satisfactionPercentage', finalSatisfaction);
            updateChartBar('selfKnowledgeBar', 'selfKnowledgePercentage', finalSelfKnowledge);
            updateChartBar('fantasyBar', 'fantasyPercentage', finalFantasyDiversity);
            updateChartBar('emotionBar', 'emotionPercentage', finalEmotionInSex);


            // --- Textual Summaries based on Scores ---
            let orientationText = "";
            let communicationText = "";
            let fantasyText = "";
            let generalRecommendation = "";

            const gender = answers.gender;
            const maritalStatus = answers.maritalStatus;

            // Example textual analysis for orientation based on question 5 (if it was randomly selected)
            const q5Answer = answers[5];
            if (q5Answer !== undefined) {
                const orientationOption = allQuestions.find(q => q.id === 5).options[q5Answer];
                orientationText = `گرایش جنسی که شما انتخاب کردید: <strong>${orientationOption}</strong>. این نشان‌دهنده میزان شناخت شما از هویت جنسی خود یا کنجکاوی‌های احتمالی شماست.`;
            } else {
                orientationText = "با توجه به سوالاتی که پاسخ دادید، نمی‌توان تحلیل دقیقی از گرایش جنسی شما ارائه داد. (ممکن است سوال مربوطه نمایش داده نشده باشد)";
            }
            document.getElementById('orientationSummary').innerHTML = orientationText;

            if (finalFantasyDiversity > 70) {
                fantasyText = "شما فردی با <strong>فانتزی‌های متنوع و رویکردی باز به تجربه‌های جدید جنسی</strong> هستید. این می‌تواند نشان‌دهنده روحیه ماجراجو در شما باشد.";
            } else if (finalFantasyDiversity > 40) {
                fantasyText = "میزان تمایل شما به <strong>فانتزی و تنوع در حد متوسط</strong> است. ممکن است برخی تجربه‌های جدید برایتان جذاب باشد اما با احتیاط عمل می‌کنید.";
            } else {
                fantasyText = "به نظر می‌رسد شما <strong>گرایش کمتری به فانتزی‌های پیچیده یا تنوع زیاد</strong> در روابط جنسی دارید و بیشتر به دنبال ثبات و سادگی هستید.";
            }
            document.getElementById('fantasySummary').innerHTML = fantasyText;

            if (finalEmotionInSex > 70) {
                communicationText = "<strong>عواطف و احساسات نقش پررنگی در تجربه جنسی شما دارند.</strong> ارتباط عاطفی عمیق برای رضایت جنسی شما ضروری به نظر می‌رسد.";
            } else if (finalEmotionInSex > 40) {
                communicationText = "برای شما، <strong>هم عاطفه و هم لذت بدنی در سکس مهم هستند</strong> و به دنبال تعادل بین این دو هستید.";
            } else {
                communicationText = "شما ممکن است <strong>لذت بدنی را بر ارتباط عاطفی در سکس ارجح بدانید</strong>. این می‌تواند به معنای تمرکز بیشتر بر ابعاد فیزیکی رابطه باشد.";
            }
            document.getElementById('communicationSummary').innerHTML = communicationText;

            generalRecommendation = `
                بر اساس تحلیل کلی، با سن ${answers.age}، وضعیت تأهل ${maritalStatus} و جنسیت ${gender}، نتایج شما به شرح زیر است:
                <ul>
                    <li><strong>رضایت از رابطه:</strong> ${finalSatisfaction}%</li>
                    <li><strong>میزان خودشناسی جنسی:</strong> ${finalSelfKnowledge}%</li>
                    <li><strong>تمایل به فانتزی و تنوع:</strong> ${finalFantasyDiversity}%</li>
                    <li><strong>اهمیت عاطفه در سکس:</strong> ${finalEmotionInSex}%</li>
                </ul>
                <p>اینها تنها نکات اولیه هستند. برای درک عمیق‌تر و راهنمایی‌های شخصی، توصیه می‌شود با یک متخصص مشورت کنید تا بتوانید نیازهای جنسی و عاطفی خود را بهتر مدیریت کنید.</p>
            `;
            document.getElementById('generalSummary').innerHTML = generalRecommendation;
        }
    </script>
</body>
</html>
